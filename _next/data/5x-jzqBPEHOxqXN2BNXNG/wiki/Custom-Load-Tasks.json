{"pageProps":{"data":{"contentHtml":"<p>Certain mods that have a big task that needs to performed when the game starts (such as Ultimate Crosspathing) can make use of Custom Load Tasks to add those tasks to the game's queue of tasks that run like Coroutines in Unity, happening over the course of multiple frames so that the game doesn't lock up.</p>\n<h1 id=\"modloadtask\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#modloadtask\"><span class=\"icon icon-link\"></span></a><a href=\"/docs/BTD_Mod_Helper.Api.ModLoadTask\">ModLoadTask</a></h1>\n<h2 id=\"required-overrides\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#required-overrides\"><span class=\"icon icon-link\"></span></a>Required Overrides</h2>\n<p><code class=\"hljs\">DisplayName</code>: What appears on screen when this task is running</p>\n<p><code class=\"hljs\">IEnumerator Coroutine</code>: The task that the game should run.</p>\n<p>For those familiar with Unity Coroutines, this is like those except every yield return statement you do will be treated as a <a href=\"https://docs.unity3d.com/ScriptReference/WaitForEndOfFrame.html\">WaitForEndOfFrame</a>.</p>\n<p>If you're not familiar, it's a way of taking advantage of C#'s <code class=\"hljs\">IEnumerator</code> class, the back bone of all things you can enumerate like arrays and lists, and using it to define a method that can be run in different sections over the course of multiple frames.</p>\n<p>When your task begins running, it'll execute all the code you've written in your <code class=\"hljs\">Coroutine</code> method up until you write</p>\n<pre><code class=\"hljs language-csharp\"><span class=\"hljs-keyword\">yield</span> <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n</code></pre>\n<p>It'll then finish its execution for that frame and wait for the next one, where it will then continue where it left off until it reaches another yield return and so on until the end of the method.</p>\n<h2 id=\"reliability\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#reliability\"><span class=\"icon icon-link\"></span></a>Reliability</h2>\n<p>The <code class=\"hljs\">ModLoadTask</code> system relies on some complex patching behind the scenes that's subject to breakage when NK updates. Because of this, the Mod Helper automatically detects if the necessary patches were successful on startup, and if they weren't, it falls back to synchronously running the LoadTasks in one very laggy from on the Title Screen like the old days.</p>\n<p>The fact that you used a Load Task should never be the lone reason why your mod doesn't work.</p>\n<h2 id=\"example\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#example\"><span class=\"icon icon-link\"></span></a>Example</h2>\n<p>This task is used internally within the Mod Helper itself to wait for all the <a href=\"/docs/BTD_Mod_Helper.Api.ModByteLoader\">ModByteLoader</a>s to be finished before continuing with other Load tasks. Show cases how you can use your yield statements even inside loops.</p>\n<pre><code class=\"hljs language-cs\"><span class=\"hljs-keyword\">internal</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">ByteWaitTask</span> : <span class=\"hljs-title\">ModLoadTask</span>\n{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">override</span> <span class=\"hljs-built_in\">string</span> DisplayName => <span class=\"hljs-string\">\"Waiting for ByteLoaders...\"</span>;\n\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&#x3C;summary></span></span>\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> Don't automatically load this ModContent, it gets added specially</span>\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&#x3C;/summary></span></span>\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">override</span> IEnumerable&#x3C;ModContent> <span class=\"hljs-title\">Load</span>()</span> => Enumerable.Empty&#x3C;ModContent>();\n\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&#x3C;summary></span></span>\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> Wait for the bytes to all be loaded</span>\n    <span class=\"hljs-comment\"><span class=\"hljs-doctag\">///</span> <span class=\"hljs-doctag\">&#x3C;/summary></span></span>\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">override</span> IEnumerator <span class=\"hljs-title\">Coroutine</span>()</span>\n    {\n        <span class=\"hljs-keyword\">while</span> (!ModByteLoader.loadedAllBytes)\n        {\n            <span class=\"hljs-keyword\">yield</span> <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n}\n</code></pre>","tableOfContentsHtml":"<nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h1\"><a class=\"toc-link toc-link-h1\" href=\"#modloadtask\">ModLoadTask</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#required-overrides\">Required Overrides</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#reliability\">Reliability</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#example\">Example</a></li></ol></li></ol></nav>","title":"Custom Load Tasks"},"sidebar":{"contentHtml":"<h5 id=\"home\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#home\"><span class=\"icon icon-link\"></span></a><a href=\"/wiki/Home\">Home</a></h5>\n<h5 id=\"install-guide\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#install-guide\"><span class=\"icon icon-link\"></span></a><a href=\"/wiki/Install-Guide\">Install Guide</a></h5>\n<h6 id=\"starting-btd-modding\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#starting-btd-modding\"><span class=\"icon icon-link\"></span></a>Starting BTD Modding</h6>\n<p><a href=\"/wiki/Prerequisites\">Prerequisites</a></p>\n<p><a href=\"/wiki/Getting-Started\">Getting Started</a></p>\n<h6 id=\"mod-helper-features\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#mod-helper-features\"><span class=\"icon icon-link\"></span></a>Mod Helper Features</h6>\n<p><a href=\"/wiki/Making-a-Custom-Tower\"><strong>Making a Custom Tower</strong></a></p>\n<p><a href=\"/wiki/Making-a-Custom-Paragon\"><strong>Making a Custom Paragon</strong></a></p>\n<p><a href=\"/wiki/Making-a-Custom-Hero\"><strong>Making a Custom Hero</strong></a></p>\n<p><a href=\"/wiki/Appearing-in-the-Mod-Browser\"><strong>Appearing in the Mod Browser</strong></a></p>\n<p><a href=\"/wiki/Localization\">Localization</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Bloon\">Making a Custom Bloon</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Game-Mode\">Making a Custom Game Mode</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Round-Set\">Making a Custom Round Set</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Jukebox-Track\">Making a Custom Jukebox Track</a></p>\n<p><a href=\"/wiki/Custom-UI\">Custom UI (ModHelperComponents)</a></p>\n<p><a href=\"/wiki/Custom-Menu-Screens\">Custom Menu Screens</a></p>\n<p><a href=\"/wiki/Custom-Byte-Loaders\">Custom Byte Loaders</a></p>\n<h6 id=\"btd-modding-info\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#btd-modding-info\"><span class=\"icon icon-link\"></span></a>BTD Modding Info</h6>\n<p><a href=\"/wiki/BTD6-Internal-Structure\">BTD6 Internal Structure</a></p>\n<p><a href=\"/wiki/Looking-at-BTD6-Code-(Sorta)\">Looking at BTD6 Code (Sorta)</a></p>\n<p><a href=\"/wiki/IL2CPP-Is-Weird\">IL2CPP Is Weird</a></p>\n<p><a href=\"/wiki/Useful-Resources\">Useful Resources</a></p>\n<h6 id=\"mod-helper-utilities\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#mod-helper-utilities\"><span class=\"icon icon-link\"></span></a>Mod Helper Utilities</h6>\n<p><a href=\"/wiki/Using-Mod-Helper-Hooks\">Using Mod Helper Hooks</a></p>\n<p><a href=\"/wiki/ModContent\">ModContent</a></p>\n<p><a href=\"/wiki/Custom-Textures-and-Displays\">Custom Textures and Displays</a></p>\n<p><a href=\"/wiki/Mod-Settings\">In Game Mod Settings</a></p>\n<h6 id=\"extension-methods\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#extension-methods\"><span class=\"icon icon-link\"></span></a>Extension Methods</h6>\n<p><a href=\"/wiki/Common-Extension-Methods\">Common Extension Methods</a></p>\n<p><a href=\"/wiki/Array-extension-methods\">Array Extension Methods</a></p>","tableOfContentsHtml":"<nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h5\"><a class=\"toc-link toc-link-h5\" href=\"#home\">Home</a></li><li class=\"toc-item toc-item-h5\"><a class=\"toc-link toc-link-h5\" href=\"#install-guide\">Install Guide</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#starting-btd-modding\">Starting BTD Modding</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#mod-helper-features\">Mod Helper Features</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#btd-modding-info\">BTD Modding Info</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#mod-helper-utilities\">Mod Helper Utilities</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#extension-methods\">Extension Methods</a></li></ol></li></ol></nav>"}},"__N_SSG":true}