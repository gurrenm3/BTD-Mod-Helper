{"pageProps":{"data":{"contentHtml":"<p>Some useful information about the internal structure of BTD6 so that you don't have to find it out yourself.</p>\n<h2 id=\"gameinstance\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#gameinstance\"><span class=\"icon icon-link\"></span></a>Game.instance</h2>\n<p>From any of your .cs files, you can use <code class=\"hljs\">Game.instance</code> to access the BloonTD6 <code class=\"hljs\">Game</code>. This class contains many important references to the data structures that power the overall running of the game.</p>\n<h2 id=\"the-gamemodel\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#the-gamemodel\"><span class=\"icon icon-link\"></span></a>The GameModel</h2>\n<p>Arguably the most important thing you'll find in <code class=\"hljs\">Game.instance</code> is <code class=\"hljs\">Game.instance.model</code> which is the main instance of the BloonsTD6 <code class=\"hljs\">GameModel</code> (but importantly not the only one). The <code class=\"hljs\">GameModel</code> isn't a model like a 3D display model, but rather a blueprint / collection of blueprints for playing a match of BloonsTD6.</p>\n<p>For instance, for all the information about Towers, such as their behavior, cost, damage, etc are all held in <code class=\"hljs\">TowerModels</code> that you can find in <code class=\"hljs\">Game.instance.model.towers</code>. The <code class=\"hljs\">GameModel</code> contains various methods for finding <code class=\"hljs\">TowerModels</code> such as <code class=\"hljs\">GetTower()</code> and <code class=\"hljs\">GetTowerFromId()</code>.</p>\n<p>Similarly all the information about upgrades are stored in the <code class=\"hljs\">UpgradeModel</code>s of <code class=\"hljs\">Game.instance.model.upgrades</code>, all the Bloons in <code class=\"hljs\">BloonModel</code>s of <code class=\"hljs\">Game.instance.model.bloons</code> and etc.</p>\n<h2 id=\"ingameinstance\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#ingameinstance\"><span class=\"icon icon-link\"></span></a>InGame.instance</h2>\n<p>Similarly to <code class=\"hljs\">Game.instance</code>, you can use <code class=\"hljs\">InGame.instance</code> in any of your .cs files to access the <code class=\"hljs\">InGame</code> class which has a lot of important information and functions relating to running the current match of BTD6.</p>\n<h2 id=\"unitytosimulation-aka-the-bridge\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#unitytosimulation-aka-the-bridge\"><span class=\"icon icon-link\"></span></a>UnityToSimulation (aka the \"bridge\")</h2>\n<p>The <code class=\"hljs\">UnityToSimulation</code> class found at <code class=\"hljs\">InGame.instance.bridge</code> controls the interaction between the simulation (all of the information about the current state) and Unity (the engine powering the visualization of the game. This has more methods for handling / manipulating current match information, so if you didn't find what you were looking for in <code class=\"hljs\">InGame.instance</code>, this is another good place to look.</p>\n<p>Also in this class <code class=\"hljs\">InGame.instance.bridge.Model</code> or (<code class=\"hljs\">InGame.instance.GetGameModel()</code> with our extension method) is another <code class=\"hljs\">GameModel</code> class. Read more to see why this is.</p>\n<h2 id=\"cloned-gamemodels\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#cloned-gamemodels\"><span class=\"icon icon-link\"></span></a>Cloned GameModels</h2>\n<p>The <code class=\"hljs\">GameModel</code> that can be found at <code class=\"hljs\">Game.instance.model</code> is in a pure / default state, effectively. It has all the <code class=\"hljs\">TowerModels</code> unmodified by Monkey Knowledge, all at their Medium difficulty price, etc.</p>\n<p>When starting a new match of BTD6, the game makes a clone of this base <code class=\"hljs\">GameModel</code>, and then applies all the necessary modifications to it (the things that are referred to as \"mods\" in the source code). This includes things like Monkey Knowledge, Difficulty based pricing, CHIMPS rules, and more.</p>\n<p>Thus, when making a mod, you as a modder need to decide which <code class=\"hljs\">GameModel</code> would be better to modify.</p>\n<p>You can use the <code class=\"hljs\">OnGameModelLoaded()</code> hook in your BloonsTD6Mod file to change the core <code class=\"hljs\">GameModel</code> if you're doing something very important. This is dangerous, however, because other mods could implicitly rely on certain default functionality of the core <code class=\"hljs\">GameModel</code>.</p>\n<p>The alternative is to use the <code class=\"hljs\">OnNewGameModel()</code> hook to modify the newly cloned <code class=\"hljs\">GameModel</code> whenever a match starts. This has the benefit of being safer with respect to other mods, as well as being able to interact with Monkey Knowledge and such. If you only sometimes want to make a change to the <code class=\"hljs\">GameModel</code>, this is definitely the way to go. Additionally, if we as a modding community ever want to get to the point where we can load and unload mods without restarting the game, this is the way we have to change the <code class=\"hljs\">GameModel</code>.</p>","tableOfContentsHtml":"<nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#gameinstance\">Game.instance</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#the-gamemodel\">The GameModel</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#ingameinstance\">InGame.instance</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#unitytosimulation-aka-the-bridge\">UnityToSimulation (aka the \"bridge\")</a></li><li class=\"toc-item toc-item-h2\"><a class=\"toc-link toc-link-h2\" href=\"#cloned-gamemodels\">Cloned GameModels</a></li></ol></nav>","title":"BTD6 Internal Structure"},"sidebar":{"contentHtml":"<h5 id=\"home\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#home\"><span class=\"icon icon-link\"></span></a><a href=\"/wiki/Home\">Home</a></h5>\n<h6 id=\"starting-btd-modding\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#starting-btd-modding\"><span class=\"icon icon-link\"></span></a>Starting BTD Modding</h6>\n<p><a href=\"/wiki/Prerequisites\">Prerequisites</a></p>\n<p><a href=\"/wiki/Getting-Started\">Getting Started</a></p>\n<h6 id=\"mod-helper-features\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#mod-helper-features\"><span class=\"icon icon-link\"></span></a>Mod Helper Features</h6>\n<p><a href=\"/wiki/Making-a-Custom-Tower\"><strong>Making a Custom Tower</strong></a></p>\n<p><a href=\"/wiki/Making-a-Custom-Paragon\"><strong>Making a Custom Paragon</strong></a></p>\n<p><a href=\"/wiki/Making-a-Custom-Hero\"><strong>Making a Custom Hero</strong></a></p>\n<h6 id=\"30-features\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#30-features\"><span class=\"icon icon-link\"></span></a>3.0 Features</h6>\n<p><a href=\"/wiki/Appearing-in-the-Mod-Browser\"><strong>Appearing in the Mod Browser</strong></a></p>\n<p><a href=\"/wiki/Making-a-Custom-Bloon\">Making a Custom Bloon</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Game-Mode\">Making a Custom Game Mode</a></p>\n<p><a href=\"/wiki/Making-a-Custom-Round-Set\">Making a Custom Round Set</a></p>\n<p><a href=\"/wiki/Custom-UI\">Custom UI (ModHelperComponents)</a></p>\n<p><a href=\"/wiki/Custom-Menu-Screens\">Custom Menu Screens</a></p>\n<p><a href=\"/wiki/Custom-Byte-Loaders\">Custom Byte Loaders</a></p>\n<h6 id=\"btd-modding-info\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#btd-modding-info\"><span class=\"icon icon-link\"></span></a>BTD Modding Info</h6>\n<p><a href=\"/wiki/BTD6-Internal-Structure\">BTD6 Internal Structure</a></p>\n<p><a href=\"/wiki/Looking-at-BTD6-Code-(Sorta)\">Looking at BTD6 Code (Sorta)</a></p>\n<p><a href=\"/wiki/IL2CPP-Is-Weird\">IL2CPP Is Weird</a></p>\n<p><a href=\"/wiki/Useful-Resources\">Useful Resources</a></p>\n<h6 id=\"mod-helper-utilities\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#mod-helper-utilities\"><span class=\"icon icon-link\"></span></a>Mod Helper Utilities</h6>\n<p><a href=\"/wiki/Using-Mod-Helper-Hooks\">Using Mod Helper Hooks</a></p>\n<p><a href=\"/wiki/ModContent\">ModContent</a></p>\n<p><a href=\"/wiki/Custom-Textures-and-Displays\">Custom Textures and Displays</a></p>\n<p><a href=\"/wiki/Mod-Settings\">In Game Mod Settings</a></p>\n<h6 id=\"extension-methods\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"\" href=\"#extension-methods\"><span class=\"icon icon-link\"></span></a>Extension Methods</h6>\n<p><a href=\"/wiki/Common-Extension-Methods\">Common Extension Methods</a></p>\n<p><a href=\"/wiki/Array-extension-methods\">Array Extension Methods</a></p>","tableOfContentsHtml":"<nav class=\"toc\"><ol class=\"toc-level toc-level-1\"><li class=\"toc-item toc-item-h5\"><a class=\"toc-link toc-link-h5\" href=\"#home\">Home</a><ol class=\"toc-level toc-level-2\"><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#starting-btd-modding\">Starting BTD Modding</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#mod-helper-features\">Mod Helper Features</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#30-features\">3.0 Features</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#btd-modding-info\">BTD Modding Info</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#mod-helper-utilities\">Mod Helper Utilities</a></li><li class=\"toc-item toc-item-h6\"><a class=\"toc-link toc-link-h6\" href=\"#extension-methods\">Extension Methods</a></li></ol></li></ol></nav>"}},"__N_SSG":true}