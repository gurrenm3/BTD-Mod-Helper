(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[234],{37691:function(t,e){!function(t){"use strict";var e,r,n,o,s="__namespace",isNodeLike=function(t){var e;return t&&((e=t.nodeType)===s||Number.isInteger(e)&&e>=1&&e<=11)&&"string"==typeof t.nodeName},forEach=function(t,e){for(var r=0;r<e.length;r+=1)t(e[r],r,e)},reduce=function(t,e,r){var n=e;return forEach(function(e,r){n=t(n,e,r)},r),n},map=function(t,e){var r=Array(e.length);return forEach(function(e,n){r[n]=t(e)},e),r},filter=function(t,e){var r=[];return forEach(function(e,n){t(e,n)&&r.push(e)},e),r},includes=function(t,e){for(var r=0;r<t.length;r+=1)if(t[r]===e)return!0;return!1};function toString(t){return t.toString()}var join=function(t,e){return e.join(t)},wrap=function(t,e,r){return t+r+e},i=Array.prototype.concat,sortNodes=function(t,e){var r=new XNodeSet;r.addArray(t);var n=r.toArray();return e?n.reverse():n};function assign(t,e){for(var r=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r}var a={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NAMESPACE_NODE:s};function XPathParser(){this.init()}function XPath(t){this.expression=t}function setIfUnset(t,e,r){e in t||(t[e]=r)}function Expression(){}function UnaryOperation(t){arguments.length>0&&this.init(t)}function UnaryMinusOperation(t){arguments.length>0&&this.init(t)}function BinaryOperation(t,e){arguments.length>0&&this.init(t,e)}function OrOperation(t,e){arguments.length>0&&this.init(t,e)}function AndOperation(t,e){arguments.length>0&&this.init(t,e)}function EqualsOperation(t,e){arguments.length>0&&this.init(t,e)}function NotEqualOperation(t,e){arguments.length>0&&this.init(t,e)}function LessThanOperation(t,e){arguments.length>0&&this.init(t,e)}function GreaterThanOperation(t,e){arguments.length>0&&this.init(t,e)}function LessThanOrEqualOperation(t,e){arguments.length>0&&this.init(t,e)}function GreaterThanOrEqualOperation(t,e){arguments.length>0&&this.init(t,e)}function PlusOperation(t,e){arguments.length>0&&this.init(t,e)}function MinusOperation(t,e){arguments.length>0&&this.init(t,e)}function MultiplyOperation(t,e){arguments.length>0&&this.init(t,e)}function DivOperation(t,e){arguments.length>0&&this.init(t,e)}function ModOperation(t,e){arguments.length>0&&this.init(t,e)}function BarOperation(t,e){arguments.length>0&&this.init(t,e)}function PathExpr(t,e,r){arguments.length>0&&this.init(t,e,r)}XPathParser.prototype={},XPathParser.prototype.constructor=XPathParser,XPathParser.superclass=Object.prototype,XPathParser.prototype.init=function(){this.reduceActions=[],this.reduceActions[3]=function(t){return new OrOperation(t[0],t[2])},this.reduceActions[5]=function(t){return new AndOperation(t[0],t[2])},this.reduceActions[7]=function(t){return new EqualsOperation(t[0],t[2])},this.reduceActions[8]=function(t){return new NotEqualOperation(t[0],t[2])},this.reduceActions[10]=function(t){return new LessThanOperation(t[0],t[2])},this.reduceActions[11]=function(t){return new GreaterThanOperation(t[0],t[2])},this.reduceActions[12]=function(t){return new LessThanOrEqualOperation(t[0],t[2])},this.reduceActions[13]=function(t){return new GreaterThanOrEqualOperation(t[0],t[2])},this.reduceActions[15]=function(t){return new PlusOperation(t[0],t[2])},this.reduceActions[16]=function(t){return new MinusOperation(t[0],t[2])},this.reduceActions[18]=function(t){return new MultiplyOperation(t[0],t[2])},this.reduceActions[19]=function(t){return new DivOperation(t[0],t[2])},this.reduceActions[20]=function(t){return new ModOperation(t[0],t[2])},this.reduceActions[22]=function(t){return new UnaryMinusOperation(t[1])},this.reduceActions[24]=function(t){return new BarOperation(t[0],t[2])},this.reduceActions[25]=function(t){return new PathExpr(void 0,void 0,t[0])},this.reduceActions[27]=function(t){return t[0].locationPath=t[2],t[0]},this.reduceActions[28]=function(t){return t[0].locationPath=t[2],t[0].locationPath.steps.unshift(new Step(Step.DESCENDANTORSELF,NodeTest.nodeTest,[])),t[0]},this.reduceActions[29]=function(t){return new PathExpr(t[0],[],void 0)},this.reduceActions[30]=function(t){return h.instance_of(t[0],PathExpr)?(void 0==t[0].filterPredicates&&(t[0].filterPredicates=[]),t[0].filterPredicates.push(t[1]),t[0]):new PathExpr(t[0],[t[1]],void 0)},this.reduceActions[32]=function(t){return t[1]},this.reduceActions[33]=function(t){return new XString(t[0])},this.reduceActions[34]=function(t){return new XNumber(t[0])},this.reduceActions[36]=function(t){return new FunctionCall(t[0],[])},this.reduceActions[37]=function(t){return new FunctionCall(t[0],t[2])},this.reduceActions[38]=function(t){return[t[0]]},this.reduceActions[39]=function(t){return t[2].unshift(t[0]),t[2]},this.reduceActions[43]=function(t){return new LocationPath(!0,[])},this.reduceActions[44]=function(t){return t[1].absolute=!0,t[1]},this.reduceActions[46]=function(t){return new LocationPath(!1,[t[0]])},this.reduceActions[47]=function(t){return t[0].steps.push(t[2]),t[0]},this.reduceActions[49]=function(t){return new Step(t[0],t[1],[])},this.reduceActions[50]=function(t){return new Step(Step.CHILD,t[0],[])},this.reduceActions[51]=function(t){return new Step(t[0],t[1],t[2])},this.reduceActions[52]=function(t){return new Step(Step.CHILD,t[0],t[1])},this.reduceActions[54]=function(t){return[t[0]]},this.reduceActions[55]=function(t){return t[1].unshift(t[0]),t[1]},this.reduceActions[56]=function(t){if("ancestor"==t[0])return Step.ANCESTOR;if("ancestor-or-self"==t[0])return Step.ANCESTORORSELF;if("attribute"==t[0])return Step.ATTRIBUTE;if("child"==t[0])return Step.CHILD;if("descendant"==t[0])return Step.DESCENDANT;if("descendant-or-self"==t[0])return Step.DESCENDANTORSELF;if("following"==t[0])return Step.FOLLOWING;else if("following-sibling"==t[0])return Step.FOLLOWINGSIBLING;else if("namespace"==t[0])return Step.NAMESPACE;else if("parent"==t[0])return Step.PARENT;else if("preceding"==t[0])return Step.PRECEDING;else if("preceding-sibling"==t[0])return Step.PRECEDINGSIBLING;else if("self"==t[0])return Step.SELF;return -1},this.reduceActions[57]=function(t){return Step.ATTRIBUTE},this.reduceActions[59]=function(t){return"comment"==t[0]?NodeTest.commentTest:"text"==t[0]?NodeTest.textTest:"processing-instruction"==t[0]?NodeTest.anyPiTest:"node"==t[0]?NodeTest.nodeTest:new NodeTest(-1,void 0)},this.reduceActions[60]=function(t){return new NodeTest.PITest(t[2])},this.reduceActions[61]=function(t){return t[1]},this.reduceActions[63]=function(t){return t[1].absolute=!0,t[1].steps.unshift(new Step(Step.DESCENDANTORSELF,NodeTest.nodeTest,[])),t[1]},this.reduceActions[64]=function(t){return t[0].steps.push(new Step(Step.DESCENDANTORSELF,NodeTest.nodeTest,[])),t[0].steps.push(t[2]),t[0]},this.reduceActions[65]=function(t){return new Step(Step.SELF,NodeTest.nodeTest,[])},this.reduceActions[66]=function(t){return new Step(Step.PARENT,NodeTest.nodeTest,[])},this.reduceActions[67]=function(t){return new VariableReference(t[1])},this.reduceActions[68]=function(t){return NodeTest.nameTestAny},this.reduceActions[69]=function(t){return new NodeTest.NameTestPrefixAny(t[0].split(":")[0])},this.reduceActions[70]=function(t){return new NodeTest.NameTestQName(t[0])}},XPathParser.actionTable=[" s s        sssssssss    s ss  s  ss","                 s                  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                rrrrr               "," s s        sssssssss    s ss  s  ss","rs  rrrrrrrr s  sssssrrrrrr  rrs rs "," s s        sssssssss    s ss  s  ss","                            s       ","                            s       ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","  s                                 ","                            s       "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr  r  ","a                                   ","r       s                    rr  r  ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrs  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  srrrrrrrr         rrrrrrs rr sr  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                sssss               ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  srrrrrrrr         rrrrrrs rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","              s                     ","                             s      ","                rrrrr               "," s s        sssssssss    s sss s  ss","r  srrrrrrrr         rrrrrrs rr  r  "," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss      ss  s  ss"," s s        sssssssss    s ss  s  ss"," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr rr  "," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             rr     ","                             s      ","                             rs     ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","                                 r  ","                                 s  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  "," s s        sssssssss    s ss  s  ss","r  rrrrrrrrr         rrrrrrr rr rr  ","                             r      "],XPathParser.actionTableNumber=[" 1 0        /.-,+*)('    & %$  #  \"!","                 J                  ","a  aaaaaaaaa         aaaaaaa aa  a  ","                YYYYY               "," 1 0        /.-,+*)('    & %$  #  \"!","K1  KKKKKKKK .  +*)('KKKKKK  KK# K\" "," 1 0        /.-,+*)('    & %$  #  \"!","                            N       ","                            O       ","e  eeeeeeeee         eeeeeee ee ee  ","f  fffffffff         fffffff ff ff  ","d  ddddddddd         ddddddd dd dd  ","B  BBBBBBBBB         BBBBBBB BB BB  ","A  AAAAAAAAA         AAAAAAA AA AA  ","  P                                 ","                            Q       "," 1           .  +*)('          #  \" ","b  bbbbbbbbb         bbbbbbb bb  b  ","                                    ","!       S                    !!  !  ",'"      T"                    ""  "  ',"$   V  $$            U       $$  $  ","&   &ZY&&            &XW     &&  &  ",")   )))))            )))\\[   ))  )  ",".   ....._^]         .....   ..  .  ","1   11111111         11111   11  1  ","5   55555555         55555`  55  5  ","7   77777777         777777  77  7  ","9   99999999         999999  99  9  ",":  c::::::::         ::::::b :: a:  ","I  fIIIIIIII         IIIIIIe II  I  ","=  =========         ======= == ==  ","?  ?????????         ??????? ?? ??  ","C  CCCCCCCCC         CCCCCCC CC CC  ","J   JJJJJJJJ         JJJJJJ  JJ  J  ","M   MMMMMMMM         MMMMMM  MM  M  ","N  NNNNNNNNN         NNNNNNN NN  N  ","P  PPPPPPPPP         PPPPPPP PP  P  ","                +*)('               ","R  RRRRRRRRR         RRRRRRR RR aR  ","U  UUUUUUUUU         UUUUUUU UU  U  ","Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  ","c  ccccccccc         ccccccc cc cc  ","                             j      ","L  fLLLLLLLL         LLLLLLe LL  L  ","6   66666666         66666   66  6  ","              k                     ","                             l      ","                XXXXX               "," 1 0        /.-,+*)('    & %$m #  \"!","_  f________         ______e __  _  "," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('      %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ",">  >>>>>>>>>         >>>>>>> >> >>  "," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ","Q  QQQQQQQQQ         QQQQQQQ QQ aQ  ","V  VVVVVVVVV         VVVVVVV VV aV  ","T  TTTTTTTTT         TTTTTTT TT  T  ","@  @@@@@@@@@         @@@@@@@ @@ @@  ","                             \x87      ","[  [[[[[[[[[         [[[[[[[ [[ [[  ","D  DDDDDDDDD         DDDDDDD DD DD  ","                             HH     ","                             \x88      ","                             F\x89     ","#      T#                    ##  #  ","%   V  %%            U       %%  %  ","'   'ZY''            'XW     ''  '  ","(   (ZY((            (XW     ((  (  ","+   +++++            +++\\[   ++  +  ","*   *****            ***\\[   **  *  ","-   -----            ---\\[   --  -  ",",   ,,,,,            ,,,\\[   ,,  ,  ","0   00000_^]         00000   00  0  ","/   /////_^]         /////   //  /  ","2   22222222         22222   22  2  ","3   33333333         33333   33  3  ","4   44444444         44444   44  4  ","8   88888888         888888  88  8  ","                                 ^  ","                                 \x8a  ",";  f;;;;;;;;         ;;;;;;e ;;  ;  ","<  f<<<<<<<<         <<<<<<e <<  <  ","O  OOOOOOOOO         OOOOOOO OO  O  ","`  `````````         ``````` ``  `  ","S  SSSSSSSSS         SSSSSSS SS  S  ","W  WWWWWWWWW         WWWWWWW WW  W  ","\\  \\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\ \\\\ \\\\  ","E  EEEEEEEEE         EEEEEEE EE EE  "," 1 0        /.-,+*)('    & %$  #  \"!","]  ]]]]]]]]]         ]]]]]]] ]] ]]  ","                             G      "],XPathParser.gotoTable=["3456789:;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","L456789:;<=>?@ AB  CDEFGH IJ ","            M        EFGH IJ ","       N;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","            S        EFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              e              ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                        h  J ","              i          j   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABpqCDEFGH IJ ","                             ","  r6789:;<=>?@ AB  CDEFGH IJ ","   s789:;<=>?@ AB  CDEFGH IJ ","    t89:;<=>?@ AB  CDEFGH IJ ","    u89:;<=>?@ AB  CDEFGH IJ ","     v9:;<=>?@ AB  CDEFGH IJ ","     w9:;<=>?@ AB  CDEFGH IJ ","     x9:;<=>?@ AB  CDEFGH IJ ","     y9:;<=>?@ AB  CDEFGH IJ ","      z:;<=>?@ AB  CDEFGH IJ ","      {:;<=>?@ AB  CDEFGH IJ ","       |;<=>?@ AB  CDEFGH IJ ","       };<=>?@ AB  CDEFGH IJ ","       ~;<=>?@ AB  CDEFGH IJ ","         \x7f=>?@ AB  CDEFGH IJ ","\x80456789:;<=>?@ AB  CDEFGH IJ\x81","            \x82        EFGH IJ ","            \x83        EFGH IJ ","                             ","                     \x84 GH IJ ","                     \x85 GH IJ ","              i          \x86   ","              i          \x87   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ AB\x8cqCDEFGH IJ ","                             ","                             "],XPathParser.productions=[[1,1,2],[2,1,3],[3,1,4],[3,3,3,-9,4],[4,1,5],[4,3,4,-8,5],[5,1,6],[5,3,5,-22,6],[5,3,5,-5,6],[6,1,7],[6,3,6,-23,7],[6,3,6,-24,7],[6,3,6,-6,7],[6,3,6,-7,7],[7,1,8],[7,3,7,-25,8],[7,3,7,-26,8],[8,1,9],[8,3,8,-12,9],[8,3,8,-11,9],[8,3,8,-10,9],[9,1,10],[9,2,-26,9],[10,1,11],[10,3,10,-27,11],[11,1,12],[11,1,13],[11,3,13,-28,14],[11,3,13,-4,14],[13,1,15],[13,2,13,16],[15,1,17],[15,3,-29,2,-30],[15,1,-15],[15,1,-16],[15,1,18],[18,3,-13,-29,-30],[18,4,-13,-29,19,-30],[19,1,20],[19,3,20,-31,19],[20,1,2],[12,1,14],[12,1,21],[21,1,-28],[21,2,-28,14],[21,1,22],[14,1,23],[14,3,14,-28,23],[14,1,24],[23,2,25,26],[23,1,26],[23,3,25,26,27],[23,2,26,27],[23,1,28],[27,1,16],[27,2,16,27],[25,2,-14,-3],[25,1,-32],[26,1,29],[26,3,-20,-29,-30],[26,4,-21,-29,-15,-30],[16,3,-33,30,-34],[30,1,2],[22,2,-4,14],[24,3,14,-4,23],[28,1,-35],[28,1,-2],[17,2,-36,-18],[29,1,-17],[29,1,-19],[29,1,-18]],XPathParser.DOUBLEDOT=2,XPathParser.DOUBLECOLON=3,XPathParser.DOUBLESLASH=4,XPathParser.NOTEQUAL=5,XPathParser.LESSTHANOREQUAL=6,XPathParser.GREATERTHANOREQUAL=7,XPathParser.AND=8,XPathParser.OR=9,XPathParser.MOD=10,XPathParser.DIV=11,XPathParser.MULTIPLYOPERATOR=12,XPathParser.FUNCTIONNAME=13,XPathParser.AXISNAME=14,XPathParser.LITERAL=15,XPathParser.NUMBER=16,XPathParser.ASTERISKNAMETEST=17,XPathParser.QNAME=18,XPathParser.NCNAMECOLONASTERISK=19,XPathParser.NODETYPE=20,XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL=21,XPathParser.EQUALS=22,XPathParser.LESSTHAN=23,XPathParser.GREATERTHAN=24,XPathParser.PLUS=25,XPathParser.MINUS=26,XPathParser.BAR=27,XPathParser.SLASH=28,XPathParser.LEFTPARENTHESIS=29,XPathParser.RIGHTPARENTHESIS=30,XPathParser.COMMA=31,XPathParser.AT=32,XPathParser.LEFTBRACKET=33,XPathParser.RIGHTBRACKET=34,XPathParser.DOT=35,XPathParser.DOLLAR=36,XPathParser.prototype.tokenize=function(t){for(var e=[],r=[],n=t+"\x00",o=0,s=n.charAt(o++);;){for(;" "==s||"	"==s||"\r"==s||"\n"==s;)s=n.charAt(o++);if("\x00"==s||o>=n.length)break;if("("==s){e.push(XPathParser.LEFTPARENTHESIS),r.push(s),s=n.charAt(o++);continue}if(")"==s){e.push(XPathParser.RIGHTPARENTHESIS),r.push(s),s=n.charAt(o++);continue}if("["==s){e.push(XPathParser.LEFTBRACKET),r.push(s),s=n.charAt(o++);continue}if("]"==s){e.push(XPathParser.RIGHTBRACKET),r.push(s),s=n.charAt(o++);continue}if("@"==s){e.push(XPathParser.AT),r.push(s),s=n.charAt(o++);continue}if(","==s){e.push(XPathParser.COMMA),r.push(s),s=n.charAt(o++);continue}if("|"==s){e.push(XPathParser.BAR),r.push(s),s=n.charAt(o++);continue}if("+"==s){e.push(XPathParser.PLUS),r.push(s),s=n.charAt(o++);continue}if("-"==s){e.push(XPathParser.MINUS),r.push(s),s=n.charAt(o++);continue}if("="==s){e.push(XPathParser.EQUALS),r.push(s),s=n.charAt(o++);continue}if("$"==s){e.push(XPathParser.DOLLAR),r.push(s),s=n.charAt(o++);continue}if("."==s){if("."==(s=n.charAt(o++))){e.push(XPathParser.DOUBLEDOT),r.push(".."),s=n.charAt(o++);continue}if(s>="0"&&s<="9"){var i="."+s;for(s=n.charAt(o++);s>="0"&&s<="9";)i+=s,s=n.charAt(o++);e.push(XPathParser.NUMBER),r.push(i);continue}e.push(XPathParser.DOT),r.push(".");continue}if("'"==s||'"'==s){for(var a=s,u="";o<n.length&&(s=n.charAt(o))!==a;)u+=s,o+=1;if(s!==a)throw l.fromMessage("Unterminated string literal: "+a+u);o+=1,e.push(XPathParser.LITERAL),r.push(u),s=n.charAt(o++);continue}if(s>="0"&&s<="9"){var i=s;for(s=n.charAt(o++);s>="0"&&s<="9";)i+=s,s=n.charAt(o++);if("."==s&&n.charAt(o)>="0"&&"9">=n.charAt(o))for(i+=s+n.charAt(o++),s=n.charAt(o++);s>="0"&&s<="9";)i+=s,s=n.charAt(o++);e.push(XPathParser.NUMBER),r.push(i);continue}if("*"==s){if(e.length>0){var p=e[e.length-1];if(p!=XPathParser.AT&&p!=XPathParser.DOUBLECOLON&&p!=XPathParser.LEFTPARENTHESIS&&p!=XPathParser.LEFTBRACKET&&p!=XPathParser.AND&&p!=XPathParser.OR&&p!=XPathParser.MOD&&p!=XPathParser.DIV&&p!=XPathParser.MULTIPLYOPERATOR&&p!=XPathParser.SLASH&&p!=XPathParser.DOUBLESLASH&&p!=XPathParser.BAR&&p!=XPathParser.PLUS&&p!=XPathParser.MINUS&&p!=XPathParser.EQUALS&&p!=XPathParser.NOTEQUAL&&p!=XPathParser.LESSTHAN&&p!=XPathParser.LESSTHANOREQUAL&&p!=XPathParser.GREATERTHAN&&p!=XPathParser.GREATERTHANOREQUAL){e.push(XPathParser.MULTIPLYOPERATOR),r.push(s),s=n.charAt(o++);continue}}e.push(XPathParser.ASTERISKNAMETEST),r.push(s),s=n.charAt(o++);continue}if(":"==s&&":"==n.charAt(o)){e.push(XPathParser.DOUBLECOLON),r.push("::"),o++,s=n.charAt(o++);continue}if("/"==s){if("/"==(s=n.charAt(o++))){e.push(XPathParser.DOUBLESLASH),r.push("//"),s=n.charAt(o++);continue}e.push(XPathParser.SLASH),r.push("/");continue}if("!"==s&&"="==n.charAt(o)){e.push(XPathParser.NOTEQUAL),r.push("!="),o++,s=n.charAt(o++);continue}if("<"==s){if("="==n.charAt(o)){e.push(XPathParser.LESSTHANOREQUAL),r.push("<="),o++,s=n.charAt(o++);continue}e.push(XPathParser.LESSTHAN),r.push("<"),s=n.charAt(o++);continue}if(">"==s){if("="==n.charAt(o)){e.push(XPathParser.GREATERTHANOREQUAL),r.push(">="),o++,s=n.charAt(o++);continue}e.push(XPathParser.GREATERTHAN),r.push(">"),s=n.charAt(o++);continue}if("_"==s||h.isLetter(s.charCodeAt(0))){var c=s;for(s=n.charAt(o++);h.isNCNameChar(s.charCodeAt(0));)c+=s,s=n.charAt(o++);if(e.length>0){var p=e[e.length-1];if(p!=XPathParser.AT&&p!=XPathParser.DOUBLECOLON&&p!=XPathParser.LEFTPARENTHESIS&&p!=XPathParser.LEFTBRACKET&&p!=XPathParser.AND&&p!=XPathParser.OR&&p!=XPathParser.MOD&&p!=XPathParser.DIV&&p!=XPathParser.MULTIPLYOPERATOR&&p!=XPathParser.SLASH&&p!=XPathParser.DOUBLESLASH&&p!=XPathParser.BAR&&p!=XPathParser.PLUS&&p!=XPathParser.MINUS&&p!=XPathParser.EQUALS&&p!=XPathParser.NOTEQUAL&&p!=XPathParser.LESSTHAN&&p!=XPathParser.LESSTHANOREQUAL&&p!=XPathParser.GREATERTHAN&&p!=XPathParser.GREATERTHANOREQUAL){if("and"==c){e.push(XPathParser.AND),r.push(c);continue}if("or"==c){e.push(XPathParser.OR),r.push(c);continue}if("mod"==c){e.push(XPathParser.MOD),r.push(c);continue}if("div"==c){e.push(XPathParser.DIV),r.push(c);continue}}}if(":"==s){if("*"==n.charAt(o)){e.push(XPathParser.NCNAMECOLONASTERISK),r.push(c+":*"),o++,s=n.charAt(o++);continue}if("_"==n.charAt(o)||h.isLetter(n.charCodeAt(o))){for(c+=":",s=n.charAt(o++);h.isNCNameChar(s.charCodeAt(0));)c+=s,s=n.charAt(o++);if("("==s){e.push(XPathParser.FUNCTIONNAME),r.push(c);continue}e.push(XPathParser.QNAME),r.push(c);continue}if(":"==n.charAt(o)){e.push(XPathParser.AXISNAME),r.push(c);continue}}if("("==s){if("comment"==c||"text"==c||"node"==c){e.push(XPathParser.NODETYPE),r.push(c);continue}if("processing-instruction"==c){")"==n.charAt(o)?e.push(XPathParser.NODETYPE):e.push(XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL),r.push(c);continue}e.push(XPathParser.FUNCTIONNAME),r.push(c);continue}e.push(XPathParser.QNAME),r.push(c);continue}throw Error("Unexpected character "+s)}return e.push(1),r.push("[EOF]"),[e,r]},XPathParser.SHIFT="s",XPathParser.REDUCE="r",XPathParser.ACCEPT="a",XPathParser.prototype.parse=function(t){if(!t)throw Error("XPath expression unspecified.");if("string"!=typeof t)throw Error("XPath expression must be a string.");var e,r,n,o,s=this.tokenize(t);if(void 0!=s){e=s[0],r=s[1];var i=0,a=[],u=[],p=[];for(a.push(0),u.push(1),p.push("_S"),n=e[i],o=r[i++];;)switch(t=a[a.length-1],XPathParser.actionTable[t].charAt(n-1)){case XPathParser.SHIFT:u.push(-n),p.push(o),a.push(XPathParser.actionTableNumber[t].charCodeAt(n-1)-32),n=e[i],o=r[i++];break;case XPathParser.REDUCE:for(var c=XPathParser.productions[XPathParser.actionTableNumber[t].charCodeAt(n-1)-32][1],h=[],l=0;l<c;l++)u.pop(),h.unshift(p.pop()),a.pop();var f=a[a.length-1];u.push(XPathParser.productions[XPathParser.actionTableNumber[t].charCodeAt(n-1)-32][0]),void 0==this.reduceActions[XPathParser.actionTableNumber[t].charCodeAt(n-1)-32]?p.push(h[0]):p.push(this.reduceActions[XPathParser.actionTableNumber[t].charCodeAt(n-1)-32](h)),a.push(XPathParser.gotoTable[f].charCodeAt(XPathParser.productions[XPathParser.actionTableNumber[t].charCodeAt(n-1)-32][0]-2)-33);break;case XPathParser.ACCEPT:return new XPath(p.pop());default:throw Error("XPath parse error")}}},XPath.prototype={},XPath.prototype.constructor=XPath,XPath.superclass=Object.prototype,XPath.prototype.toString=function(){return this.expression.toString()},XPath.prototype.evaluate=function(t){var e=t.expressionContextNode;if(!(null==e||isNodeLike(e)))throw Error("Context node does not appear to be a valid DOM node.");return t.contextNode=t.expressionContextNode,t.contextSize=1,t.contextPosition=1,t.isHtml&&(setIfUnset(t,"caseInsensitive",!0),setIfUnset(t,"allowAnyNamespaceForNoPrefix",!0)),setIfUnset(t,"caseInsensitive",!1),this.expression.evaluate(t)},XPath.XML_NAMESPACE_URI="http://www.w3.org/XML/1998/namespace",XPath.XMLNS_NAMESPACE_URI="http://www.w3.org/2000/xmlns/",Expression.prototype={},Expression.prototype.constructor=Expression,Expression.superclass=Object.prototype,Expression.prototype.init=function(){},Expression.prototype.toString=function(){return"<Expression>"},Expression.prototype.evaluate=function(t){throw Error("Could not evaluate expression.")},UnaryOperation.prototype=new Expression,UnaryOperation.prototype.constructor=UnaryOperation,UnaryOperation.superclass=Expression.prototype,UnaryOperation.prototype.init=function(t){this.rhs=t},UnaryMinusOperation.prototype=new UnaryOperation,UnaryMinusOperation.prototype.constructor=UnaryMinusOperation,UnaryMinusOperation.superclass=UnaryOperation.prototype,UnaryMinusOperation.prototype.init=function(t){UnaryMinusOperation.superclass.init.call(this,t)},UnaryMinusOperation.prototype.evaluate=function(t){return this.rhs.evaluate(t).number().negate()},UnaryMinusOperation.prototype.toString=function(){return"-"+this.rhs.toString()},BinaryOperation.prototype=new Expression,BinaryOperation.prototype.constructor=BinaryOperation,BinaryOperation.superclass=Expression.prototype,BinaryOperation.prototype.init=function(t,e){this.lhs=t,this.rhs=e},OrOperation.prototype=new BinaryOperation,OrOperation.prototype.constructor=OrOperation,OrOperation.superclass=BinaryOperation.prototype,OrOperation.prototype.init=function(t,e){OrOperation.superclass.init.call(this,t,e)},OrOperation.prototype.toString=function(){return"("+this.lhs.toString()+" or "+this.rhs.toString()+")"},OrOperation.prototype.evaluate=function(t){var e=this.lhs.evaluate(t).bool();return e.booleanValue()?e:this.rhs.evaluate(t).bool()},AndOperation.prototype=new BinaryOperation,AndOperation.prototype.constructor=AndOperation,AndOperation.superclass=BinaryOperation.prototype,AndOperation.prototype.init=function(t,e){AndOperation.superclass.init.call(this,t,e)},AndOperation.prototype.toString=function(){return"("+this.lhs.toString()+" and "+this.rhs.toString()+")"},AndOperation.prototype.evaluate=function(t){var e=this.lhs.evaluate(t).bool();return e.booleanValue()?this.rhs.evaluate(t).bool():e},EqualsOperation.prototype=new BinaryOperation,EqualsOperation.prototype.constructor=EqualsOperation,EqualsOperation.superclass=BinaryOperation.prototype,EqualsOperation.prototype.init=function(t,e){EqualsOperation.superclass.init.call(this,t,e)},EqualsOperation.prototype.toString=function(){return"("+this.lhs.toString()+" = "+this.rhs.toString()+")"},EqualsOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).equals(this.rhs.evaluate(t))},NotEqualOperation.prototype=new BinaryOperation,NotEqualOperation.prototype.constructor=NotEqualOperation,NotEqualOperation.superclass=BinaryOperation.prototype,NotEqualOperation.prototype.init=function(t,e){NotEqualOperation.superclass.init.call(this,t,e)},NotEqualOperation.prototype.toString=function(){return"("+this.lhs.toString()+" != "+this.rhs.toString()+")"},NotEqualOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).notequal(this.rhs.evaluate(t))},LessThanOperation.prototype=new BinaryOperation,LessThanOperation.prototype.constructor=LessThanOperation,LessThanOperation.superclass=BinaryOperation.prototype,LessThanOperation.prototype.init=function(t,e){LessThanOperation.superclass.init.call(this,t,e)},LessThanOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).lessthan(this.rhs.evaluate(t))},LessThanOperation.prototype.toString=function(){return"("+this.lhs.toString()+" < "+this.rhs.toString()+")"},GreaterThanOperation.prototype=new BinaryOperation,GreaterThanOperation.prototype.constructor=GreaterThanOperation,GreaterThanOperation.superclass=BinaryOperation.prototype,GreaterThanOperation.prototype.init=function(t,e){GreaterThanOperation.superclass.init.call(this,t,e)},GreaterThanOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).greaterthan(this.rhs.evaluate(t))},GreaterThanOperation.prototype.toString=function(){return"("+this.lhs.toString()+" > "+this.rhs.toString()+")"},LessThanOrEqualOperation.prototype=new BinaryOperation,LessThanOrEqualOperation.prototype.constructor=LessThanOrEqualOperation,LessThanOrEqualOperation.superclass=BinaryOperation.prototype,LessThanOrEqualOperation.prototype.init=function(t,e){LessThanOrEqualOperation.superclass.init.call(this,t,e)},LessThanOrEqualOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).lessthanorequal(this.rhs.evaluate(t))},LessThanOrEqualOperation.prototype.toString=function(){return"("+this.lhs.toString()+" <= "+this.rhs.toString()+")"},GreaterThanOrEqualOperation.prototype=new BinaryOperation,GreaterThanOrEqualOperation.prototype.constructor=GreaterThanOrEqualOperation,GreaterThanOrEqualOperation.superclass=BinaryOperation.prototype,GreaterThanOrEqualOperation.prototype.init=function(t,e){GreaterThanOrEqualOperation.superclass.init.call(this,t,e)},GreaterThanOrEqualOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).greaterthanorequal(this.rhs.evaluate(t))},GreaterThanOrEqualOperation.prototype.toString=function(){return"("+this.lhs.toString()+" >= "+this.rhs.toString()+")"},PlusOperation.prototype=new BinaryOperation,PlusOperation.prototype.constructor=PlusOperation,PlusOperation.superclass=BinaryOperation.prototype,PlusOperation.prototype.init=function(t,e){PlusOperation.superclass.init.call(this,t,e)},PlusOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).number().plus(this.rhs.evaluate(t).number())},PlusOperation.prototype.toString=function(){return"("+this.lhs.toString()+" + "+this.rhs.toString()+")"},MinusOperation.prototype=new BinaryOperation,MinusOperation.prototype.constructor=MinusOperation,MinusOperation.superclass=BinaryOperation.prototype,MinusOperation.prototype.init=function(t,e){MinusOperation.superclass.init.call(this,t,e)},MinusOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).number().minus(this.rhs.evaluate(t).number())},MinusOperation.prototype.toString=function(){return"("+this.lhs.toString()+" - "+this.rhs.toString()+")"},MultiplyOperation.prototype=new BinaryOperation,MultiplyOperation.prototype.constructor=MultiplyOperation,MultiplyOperation.superclass=BinaryOperation.prototype,MultiplyOperation.prototype.init=function(t,e){MultiplyOperation.superclass.init.call(this,t,e)},MultiplyOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).number().multiply(this.rhs.evaluate(t).number())},MultiplyOperation.prototype.toString=function(){return"("+this.lhs.toString()+" * "+this.rhs.toString()+")"},DivOperation.prototype=new BinaryOperation,DivOperation.prototype.constructor=DivOperation,DivOperation.superclass=BinaryOperation.prototype,DivOperation.prototype.init=function(t,e){DivOperation.superclass.init.call(this,t,e)},DivOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).number().div(this.rhs.evaluate(t).number())},DivOperation.prototype.toString=function(){return"("+this.lhs.toString()+" div "+this.rhs.toString()+")"},ModOperation.prototype=new BinaryOperation,ModOperation.prototype.constructor=ModOperation,ModOperation.superclass=BinaryOperation.prototype,ModOperation.prototype.init=function(t,e){ModOperation.superclass.init.call(this,t,e)},ModOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).number().mod(this.rhs.evaluate(t).number())},ModOperation.prototype.toString=function(){return"("+this.lhs.toString()+" mod "+this.rhs.toString()+")"},BarOperation.prototype=new BinaryOperation,BarOperation.prototype.constructor=BarOperation,BarOperation.superclass=BinaryOperation.prototype,BarOperation.prototype.init=function(t,e){BarOperation.superclass.init.call(this,t,e)},BarOperation.prototype.evaluate=function(t){return this.lhs.evaluate(t).nodeset().union(this.rhs.evaluate(t).nodeset())},BarOperation.prototype.toString=function(){return map(toString,[this.lhs,this.rhs]).join(" | ")},PathExpr.prototype=new Expression,PathExpr.prototype.constructor=PathExpr,PathExpr.superclass=Expression.prototype,PathExpr.prototype.init=function(t,e,r){PathExpr.superclass.init.call(this),this.filter=t,this.filterPredicates=e,this.locationPath=r};var applyPredicates=function(t,e,r,n){if(0===t.length)return r;var o=e.extend({});return reduce(function(t,e){return o.contextSize=t.length,filter(function(t,r){return o.contextNode=t,o.contextPosition=r+1,PathExpr.predicateMatches(e,o)},t)},sortNodes(r,n),t)};PathExpr.getRoot=function(t,e){var r=e[0];if(r&&r.nodeType===a.DOCUMENT_NODE)return r;if(t.virtualRoot)return t.virtualRoot;if(!r)throw Error("Context node not found when determining document root.");var n=r.ownerDocument;if(n)return n;for(var o=r;null!=o.parentNode;)o=o.parentNode;return o};var getPrefixForNamespaceNode=function(t){var e=String(t.name);return"xmlns"===e?"":"xmlns:"===e.substring(0,6)?e.substring(6,e.length):null};function applyStepWithPredicates(t,e,r){return applyPredicates(t.predicates,e,PathExpr.applyStep(t,e,r),includes(u,t.axis))}function applyStepToNodes(t,e,r){return function(t){for(var e=[],r=0;r<t.length;r+=32767){var n=t.slice(r,r+32767);e=i.apply(e,n)}return e}(map(applyStepWithPredicates.bind(null,r,t),e))}function LocationPath(t,e){arguments.length>0&&this.init(t,e)}function Step(t,e,r){arguments.length>0&&this.init(t,e,r)}PathExpr.applyStep=function(t,e,r){if(!r)throw Error("Context node not found when evaluating XPath step: "+t);var n,o,s=[];switch(e.contextNode=r,t.axis){case Step.ANCESTOR:if(e.contextNode===e.virtualRoot)break;for(n=e.contextNode.nodeType==a.ATTRIBUTE_NODE?PathExpr.getOwnerElement(e.contextNode):e.contextNode.parentNode;null!=n&&(t.nodeTest.matches(n,e)&&s.push(n),n!==e.virtualRoot);)n=n.parentNode;break;case Step.ANCESTORORSELF:for(var n=e.contextNode;null!=n&&(t.nodeTest.matches(n,e)&&s.push(n),n!==e.virtualRoot);n=n.nodeType==a.ATTRIBUTE_NODE?PathExpr.getOwnerElement(n):n.parentNode);break;case Step.ATTRIBUTE:var i=e.contextNode.attributes;if(null!=i)for(var u=0;u<i.length;u++){var n=i.item(u);t.nodeTest.matches(n,e)&&s.push(n)}break;case Step.CHILD:for(var n=e.contextNode.firstChild;null!=n;n=n.nextSibling)t.nodeTest.matches(n,e)&&s.push(n);break;case Step.DESCENDANT:for(var o=[e.contextNode.firstChild];o.length>0;)for(var n=o.pop();null!=n;)t.nodeTest.matches(n,e)&&s.push(n),null!=n.firstChild?(o.push(n.nextSibling),n=n.firstChild):n=n.nextSibling;break;case Step.DESCENDANTORSELF:t.nodeTest.matches(e.contextNode,e)&&s.push(e.contextNode);for(var o=[e.contextNode.firstChild];o.length>0;)for(var n=o.pop();null!=n;)t.nodeTest.matches(n,e)&&s.push(n),null!=n.firstChild?(o.push(n.nextSibling),n=n.firstChild):n=n.nextSibling;break;case Step.FOLLOWING:if(e.contextNode===e.virtualRoot)break;var o=[];null!=e.contextNode.firstChild?o.unshift(e.contextNode.firstChild):o.unshift(e.contextNode.nextSibling);for(var n=e.contextNode.parentNode;null!=n&&n.nodeType!=a.DOCUMENT_NODE&&n!==e.virtualRoot;n=n.parentNode)o.unshift(n.nextSibling);do for(var n=o.pop();null!=n;)t.nodeTest.matches(n,e)&&s.push(n),null!=n.firstChild?(o.push(n.nextSibling),n=n.firstChild):n=n.nextSibling;while(o.length>0);break;case Step.FOLLOWINGSIBLING:if(e.contextNode===e.virtualRoot)break;for(var n=e.contextNode.nextSibling;null!=n;n=n.nextSibling)t.nodeTest.matches(n,e)&&s.push(n);break;case Step.NAMESPACE:var p={};if(e.contextNode.nodeType==a.ELEMENT_NODE){p.xml=new XPathNamespace("xml",null,XPath.XML_NAMESPACE_URI,e.contextNode);for(var n=e.contextNode;null!=n&&n.nodeType==a.ELEMENT_NODE;n=n.parentNode)for(var u=0;u<n.attributes.length;u++){var c=n.attributes.item(u),h=getPrefixForNamespaceNode(c);null!=h&&void 0==p[h]&&(p[h]=new XPathNamespace(h,c,c.value,e.contextNode))}for(var h in p){var r=p[h];t.nodeTest.matches(r,e)&&s.push(r)}}break;case Step.PARENT:n=null,e.contextNode!==e.virtualRoot&&(n=e.contextNode.nodeType==a.ATTRIBUTE_NODE?PathExpr.getOwnerElement(e.contextNode):e.contextNode.parentNode),null!=n&&t.nodeTest.matches(n,e)&&s.push(n);break;case Step.PRECEDING:o=null!=e.virtualRoot?[e.virtualRoot]:[function(t){for(;t&&t.parentNode;)t=t.parentNode;return t}(e.contextNode)];t:for(;o.length>0;)for(var n=o.pop();null!=n;){if(n==e.contextNode)break t;t.nodeTest.matches(n,e)&&s.unshift(n),null!=n.firstChild?(o.push(n.nextSibling),n=n.firstChild):n=n.nextSibling}break;case Step.PRECEDINGSIBLING:if(e.contextNode===e.virtualRoot)break;for(var n=e.contextNode.previousSibling;null!=n;n=n.previousSibling)t.nodeTest.matches(n,e)&&s.push(n);break;case Step.SELF:t.nodeTest.matches(e.contextNode,e)&&s.push(e.contextNode)}return s},PathExpr.applySteps=function(t,e,r){return reduce(applyStepToNodes.bind(null,e),r,t)},PathExpr.prototype.applyFilter=function(t,e){if(!this.filter)return{nodes:[t.contextNode]};var r=this.filter.evaluate(t);if(!h.instance_of(r,XNodeSet)){if(null!=this.filterPredicates&&this.filterPredicates.length>0||null!=this.locationPath)throw Error("Path expression filter must evaluate to a nodeset if predicates or location path are used");return{nonNodes:r}}return{nodes:applyPredicates(this.filterPredicates||[],e,r.toUnsortedArray(),!1)}},PathExpr.applyLocationPath=function(t,e,r){if(!t)return r;var n=t.absolute?[PathExpr.getRoot(e,r)]:r;return PathExpr.applySteps(t.steps,e,n)},PathExpr.prototype.evaluate=function(t){var e=assign(new XPathContext,t),r=this.applyFilter(t,e);if("nonNodes"in r)return r.nonNodes;var n=new XNodeSet;return n.addArray(PathExpr.applyLocationPath(this.locationPath,e,r.nodes)),n},PathExpr.predicateMatches=function(t,e){var r=t.evaluate(e);return h.instance_of(r,XNumber)?e.contextPosition===r.numberValue():r.booleanValue()},PathExpr.predicateString=function(t){return wrap("[","]",t.toString())},PathExpr.predicatesString=function(t){return join("",map(PathExpr.predicateString,t))},PathExpr.prototype.toString=function(){if(void 0!=this.filter){var t=toString(this.filter);return h.instance_of(this.filter,XString)?wrap("'","'",t):void 0!=this.filterPredicates&&this.filterPredicates.length?wrap("(",")",t)+PathExpr.predicatesString(this.filterPredicates):void 0!=this.locationPath?t+(this.locationPath.absolute?"":"/")+toString(this.locationPath):t}return toString(this.locationPath)},PathExpr.getOwnerElement=function(t){if(t.ownerElement)return t.ownerElement;try{if(t.selectSingleNode)return t.selectSingleNode("..")}catch(t){}for(var e=(t.nodeType==a.DOCUMENT_NODE?t:t.ownerDocument).getElementsByTagName("*"),r=0;r<e.length;r++)for(var n=e.item(r),o=n.attributes,s=0;s<o.length;s++)if(o.item(s)===t)return n;return null},LocationPath.prototype={},LocationPath.prototype.constructor=LocationPath,LocationPath.superclass=Object.prototype,LocationPath.prototype.init=function(t,e){this.absolute=t,this.steps=e},LocationPath.prototype.toString=function(){return(this.absolute?"/":"")+map(toString,this.steps).join("/")},Step.prototype={},Step.prototype.constructor=Step,Step.superclass=Object.prototype,Step.prototype.init=function(t,e,r){this.axis=t,this.nodeTest=e,this.predicates=r},Step.prototype.toString=function(){return Step.STEPNAMES[this.axis]+"::"+this.nodeTest.toString()+PathExpr.predicatesString(this.predicates)},Step.ANCESTOR=0,Step.ANCESTORORSELF=1,Step.ATTRIBUTE=2,Step.CHILD=3,Step.DESCENDANT=4,Step.DESCENDANTORSELF=5,Step.FOLLOWING=6,Step.FOLLOWINGSIBLING=7,Step.NAMESPACE=8,Step.PARENT=9,Step.PRECEDING=10,Step.PRECEDINGSIBLING=11,Step.SELF=12,Step.STEPNAMES=reduce(function(t,e){return t[e[0]]=e[1],t},{},[[Step.ANCESTOR,"ancestor"],[Step.ANCESTORORSELF,"ancestor-or-self"],[Step.ATTRIBUTE,"attribute"],[Step.CHILD,"child"],[Step.DESCENDANT,"descendant"],[Step.DESCENDANTORSELF,"descendant-or-self"],[Step.FOLLOWING,"following"],[Step.FOLLOWINGSIBLING,"following-sibling"],[Step.NAMESPACE,"namespace"],[Step.PARENT,"parent"],[Step.PRECEDING,"preceding"],[Step.PRECEDINGSIBLING,"preceding-sibling"],[Step.SELF,"self"]]);var u=[Step.ANCESTOR,Step.ANCESTORORSELF,Step.PARENT,Step.PRECEDING,Step.PRECEDINGSIBLING];function NodeTest(t,e){arguments.length>0&&this.init(t,e)}function VariableReference(t){arguments.length>0&&this.init(t)}function FunctionCall(t,e){arguments.length>0&&this.init(t,e)}NodeTest.prototype={},NodeTest.prototype.constructor=NodeTest,NodeTest.superclass=Object.prototype,NodeTest.prototype.init=function(t,e){this.type=t,this.value=e},NodeTest.prototype.toString=function(){return"<unknown nodetest type>"},NodeTest.prototype.matches=function(t,e){console.warn("unknown node test type")},NodeTest.NAMETESTANY=0,NodeTest.NAMETESTPREFIXANY=1,NodeTest.NAMETESTQNAME=2,NodeTest.COMMENT=3,NodeTest.TEXT=4,NodeTest.PI=5,NodeTest.NODE=6,NodeTest.isNodeType=function(t){return function(e){return includes(t,e.nodeType)}},NodeTest.makeNodeTestType=function(t,e,r){var n=r||function(){};return n.prototype=new NodeTest(t),n.prototype.constructor=n,assign(n.prototype,e),n},NodeTest.makeNodeTypeTest=function(t,e,r){return new(NodeTest.makeNodeTestType(t,{matches:NodeTest.isNodeType(e),toString:function(){return r}}))},NodeTest.hasPrefix=function(t){return t.prefix||-1!==(t.nodeName||t.tagName).indexOf(":")},NodeTest.isElementOrAttribute=NodeTest.isNodeType([1,2]),NodeTest.nameSpaceMatches=function(t,e,r){var n=r.namespaceURI||"";if(!t)return!n||e.allowAnyNamespaceForNoPrefix&&!NodeTest.hasPrefix(r);var o=e.namespaceResolver.getNamespace(t,e.expressionContextNode);if(null==o)throw Error("Cannot resolve QName "+t);return o===n},NodeTest.localNameMatches=function(t,e,r){var n=r.localName||r.nodeName;return e.caseInsensitive?t.toLowerCase()===n.toLowerCase():t===n},NodeTest.NameTestPrefixAny=NodeTest.makeNodeTestType(NodeTest.NAMETESTPREFIXANY,{matches:function(t,e){return NodeTest.isElementOrAttribute(t)&&NodeTest.nameSpaceMatches(this.prefix,e,t)},toString:function(){return this.prefix+":*"}},function(t){this.prefix=t}),NodeTest.NameTestQName=NodeTest.makeNodeTestType(NodeTest.NAMETESTQNAME,{matches:function(t,e){return NodeTest.isNodeType([a.ELEMENT_NODE,a.ATTRIBUTE_NODE,a.NAMESPACE_NODE])(t)&&NodeTest.nameSpaceMatches(this.prefix,e,t)&&NodeTest.localNameMatches(this.localName,e,t)},toString:function(){return this.name}},function(t){var e=t.split(":");this.name=t,this.prefix=e.length>1?e[0]:null,this.localName=e[e.length>1?1:0]}),NodeTest.PITest=NodeTest.makeNodeTestType(NodeTest.PI,{matches:function(t,e){return NodeTest.isNodeType([a.PROCESSING_INSTRUCTION_NODE])(t)&&(t.target||t.nodeName)===this.name},toString:function(){return wrap('processing-instruction("','")',this.name)}},function(t){this.name=t}),NodeTest.nameTestAny=NodeTest.makeNodeTypeTest(NodeTest.NAMETESTANY,[a.ELEMENT_NODE,a.ATTRIBUTE_NODE,a.NAMESPACE_NODE],"*"),NodeTest.textTest=NodeTest.makeNodeTypeTest(NodeTest.TEXT,[a.TEXT_NODE,a.CDATA_SECTION_NODE],"text()"),NodeTest.commentTest=NodeTest.makeNodeTypeTest(NodeTest.COMMENT,[a.COMMENT_NODE],"comment()"),NodeTest.nodeTest=NodeTest.makeNodeTypeTest(NodeTest.NODE,[a.ELEMENT_NODE,a.ATTRIBUTE_NODE,a.TEXT_NODE,a.CDATA_SECTION_NODE,a.PROCESSING_INSTRUCTION_NODE,a.COMMENT_NODE,a.DOCUMENT_NODE],"node()"),NodeTest.anyPiTest=NodeTest.makeNodeTypeTest(NodeTest.PI,[a.PROCESSING_INSTRUCTION_NODE],"processing-instruction()"),VariableReference.prototype=new Expression,VariableReference.prototype.constructor=VariableReference,VariableReference.superclass=Expression.prototype,VariableReference.prototype.init=function(t){this.variable=t},VariableReference.prototype.toString=function(){return"$"+this.variable},VariableReference.prototype.evaluate=function(t){var e=h.resolveQName(this.variable,t.namespaceResolver,t.contextNode,!1);if(null==e[0])throw Error("Cannot resolve QName "+fn);var r=t.variableResolver.getVariable(e[1],e[0]);if(!r)throw l.fromMessage("Undeclared variable: "+this.toString());return r},FunctionCall.prototype=new Expression,FunctionCall.prototype.constructor=FunctionCall,FunctionCall.superclass=Expression.prototype,FunctionCall.prototype.init=function(t,e){this.functionName=t,this.arguments=e},FunctionCall.prototype.toString=function(){for(var t=this.functionName+"(",e=0;e<this.arguments.length;e++)e>0&&(t+=", "),t+=this.arguments[e].toString();return t+")"},FunctionCall.prototype.evaluate=function(t){var e=FunctionResolver.getFunctionFromContext(this.functionName,t);if(!e)throw Error("Unknown function "+this.functionName);var r=[t].concat(this.arguments);return e.apply(t.functionResolver.thisArg,r)};var p={};function XString(t){arguments.length>0&&this.init(t)}function XNumber(t){arguments.length>0&&this.init(t)}function XBoolean(t){arguments.length>0&&this.init(t)}function AVLTree(t){this.init(t)}function XNodeSet(){this.init()}function XPathNamespace(t,e,r,n){this.isXPathNamespace=!0,this.baseNode=e,this.ownerDocument=n.ownerDocument,this.nodeName=t,this.prefix=t,this.localName=t,this.namespaceURI=null,this.nodeValue=r,this.ownerElement=n,this.nodeType=a.NAMESPACE_NODE}function XPathContext(t,e,r){this.variableResolver=null!=t?t:new VariableResolver,this.namespaceResolver=null!=e?e:new NamespaceResolver,this.functionResolver=null!=r?r:new FunctionResolver}function VariableResolver(){}function FunctionResolver(t){this.thisArg=null!=t?t:c,this.functions={},this.addStandardFunctions()}function NamespaceResolver(){}p.equals=function(t,e){return t.equals(e)},p.notequal=function(t,e){return t.notequal(e)},p.lessthan=function(t,e){return t.lessthan(e)},p.greaterthan=function(t,e){return t.greaterthan(e)},p.lessthanorequal=function(t,e){return t.lessthanorequal(e)},p.greaterthanorequal=function(t,e){return t.greaterthanorequal(e)},XString.prototype=new Expression,XString.prototype.constructor=XString,XString.superclass=Expression.prototype,XString.prototype.init=function(t){this.str=String(t)},XString.prototype.toString=function(){return this.str},XString.prototype.evaluate=function(t){return this},XString.prototype.string=function(){return this},XString.prototype.number=function(){return new XNumber(this.str)},XString.prototype.bool=function(){return new XBoolean(this.str)},XString.prototype.nodeset=function(){throw Error("Cannot convert string to nodeset")},XString.prototype.stringValue=function(){return this.str},XString.prototype.numberValue=function(){return this.number().numberValue()},XString.prototype.booleanValue=function(){return this.bool().booleanValue()},XString.prototype.equals=function(t){return h.instance_of(t,XBoolean)?this.bool().equals(t):h.instance_of(t,XNumber)?this.number().equals(t):h.instance_of(t,XNodeSet)?t.compareWithString(this,p.equals):new XBoolean(this.str==t.str)},XString.prototype.notequal=function(t){return h.instance_of(t,XBoolean)?this.bool().notequal(t):h.instance_of(t,XNumber)?this.number().notequal(t):h.instance_of(t,XNodeSet)?t.compareWithString(this,p.notequal):new XBoolean(this.str!=t.str)},XString.prototype.lessthan=function(t){return this.number().lessthan(t)},XString.prototype.greaterthan=function(t){return this.number().greaterthan(t)},XString.prototype.lessthanorequal=function(t){return this.number().lessthanorequal(t)},XString.prototype.greaterthanorequal=function(t){return this.number().greaterthanorequal(t)},XNumber.prototype=new Expression,XNumber.prototype.constructor=XNumber,XNumber.superclass=Expression.prototype,XNumber.prototype.init=function(t){this.num="string"==typeof t?this.parse(t):Number(t)},XNumber.prototype.numberFormat=/^\s*-?[0-9]*\.?[0-9]+\s*$/,XNumber.prototype.parse=function(t){return this.numberFormat.test(t)?parseFloat(t):Number.NaN},XNumber.prototype.toString=function(){var t=this.num.toString();return -1!==t.indexOf("e-")?function(t){for(var e=t.split("e-"),r=e[0].replace(".",""),n=Number(e[1]),o=0;o<n-1;o+=1)r="0"+r;return"0."+r}(t):-1!==t.indexOf("e")?function(t){for(var e=t.split("e"),r=e[0].replace(".",""),n=Number(e[1])+1-r.length,o=0;o<n;o+=1)r+="0";return r}(t):t},XNumber.prototype.evaluate=function(t){return this},XNumber.prototype.string=function(){return new XString(this.toString())},XNumber.prototype.number=function(){return this},XNumber.prototype.bool=function(){return new XBoolean(this.num)},XNumber.prototype.nodeset=function(){throw Error("Cannot convert number to nodeset")},XNumber.prototype.stringValue=function(){return this.string().stringValue()},XNumber.prototype.numberValue=function(){return this.num},XNumber.prototype.booleanValue=function(){return this.bool().booleanValue()},XNumber.prototype.negate=function(){return new XNumber(-this.num)},XNumber.prototype.equals=function(t){return h.instance_of(t,XBoolean)?this.bool().equals(t):h.instance_of(t,XString)?this.equals(t.number()):h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.equals):new XBoolean(this.num==t.num)},XNumber.prototype.notequal=function(t){return h.instance_of(t,XBoolean)?this.bool().notequal(t):h.instance_of(t,XString)?this.notequal(t.number()):h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.notequal):new XBoolean(this.num!=t.num)},XNumber.prototype.lessthan=function(t){return h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.greaterthan):h.instance_of(t,XBoolean)||h.instance_of(t,XString)?this.lessthan(t.number()):new XBoolean(this.num<t.num)},XNumber.prototype.greaterthan=function(t){return h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.lessthan):h.instance_of(t,XBoolean)||h.instance_of(t,XString)?this.greaterthan(t.number()):new XBoolean(this.num>t.num)},XNumber.prototype.lessthanorequal=function(t){return h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.greaterthanorequal):h.instance_of(t,XBoolean)||h.instance_of(t,XString)?this.lessthanorequal(t.number()):new XBoolean(this.num<=t.num)},XNumber.prototype.greaterthanorequal=function(t){return h.instance_of(t,XNodeSet)?t.compareWithNumber(this,p.lessthanorequal):h.instance_of(t,XBoolean)||h.instance_of(t,XString)?this.greaterthanorequal(t.number()):new XBoolean(this.num>=t.num)},XNumber.prototype.plus=function(t){return new XNumber(this.num+t.num)},XNumber.prototype.minus=function(t){return new XNumber(this.num-t.num)},XNumber.prototype.multiply=function(t){return new XNumber(this.num*t.num)},XNumber.prototype.div=function(t){return new XNumber(this.num/t.num)},XNumber.prototype.mod=function(t){return new XNumber(this.num%t.num)},XBoolean.prototype=new Expression,XBoolean.prototype.constructor=XBoolean,XBoolean.superclass=Expression.prototype,XBoolean.prototype.init=function(t){this.b=!!t},XBoolean.prototype.toString=function(){return this.b.toString()},XBoolean.prototype.evaluate=function(t){return this},XBoolean.prototype.string=function(){return new XString(this.b)},XBoolean.prototype.number=function(){return new XNumber(this.b)},XBoolean.prototype.bool=function(){return this},XBoolean.prototype.nodeset=function(){throw Error("Cannot convert boolean to nodeset")},XBoolean.prototype.stringValue=function(){return this.string().stringValue()},XBoolean.prototype.numberValue=function(){return this.number().numberValue()},XBoolean.prototype.booleanValue=function(){return this.b},XBoolean.prototype.not=function(){return new XBoolean(!this.b)},XBoolean.prototype.equals=function(t){return h.instance_of(t,XString)||h.instance_of(t,XNumber)?this.equals(t.bool()):h.instance_of(t,XNodeSet)?t.compareWithBoolean(this,p.equals):new XBoolean(this.b==t.b)},XBoolean.prototype.notequal=function(t){return h.instance_of(t,XString)||h.instance_of(t,XNumber)?this.notequal(t.bool()):h.instance_of(t,XNodeSet)?t.compareWithBoolean(this,p.notequal):new XBoolean(this.b!=t.b)},XBoolean.prototype.lessthan=function(t){return this.number().lessthan(t)},XBoolean.prototype.greaterthan=function(t){return this.number().greaterthan(t)},XBoolean.prototype.lessthanorequal=function(t){return this.number().lessthanorequal(t)},XBoolean.prototype.greaterthanorequal=function(t){return this.number().greaterthanorequal(t)},XBoolean.true_=new XBoolean(!0),XBoolean.false_=new XBoolean(!1),AVLTree.prototype={},AVLTree.prototype.constructor=AVLTree,AVLTree.superclass=Object.prototype,AVLTree.prototype.init=function(t){this.left=null,this.right=null,this.node=t,this.depth=1},AVLTree.prototype.balance=function(){var t=null==this.left?0:this.left.depth,e=null==this.right?0:this.right.depth;if(t>e+1)(null==this.left.left?0:this.left.left.depth)<(null==this.left.right?0:this.left.right.depth)&&this.left.rotateRR(),this.rotateLL();else if(t+1<e){var r=null==this.right.right?0:this.right.right.depth;(null==this.right.left?0:this.right.left.depth)>r&&this.right.rotateLL(),this.rotateRR()}},AVLTree.prototype.rotateLL=function(){var t=this.node,e=this.right;this.node=this.left.node,this.right=this.left,this.left=this.left.left,this.right.left=this.right.right,this.right.right=e,this.right.node=t,this.right.updateInNewLocation(),this.updateInNewLocation()},AVLTree.prototype.rotateRR=function(){var t=this.node,e=this.left;this.node=this.right.node,this.left=this.right,this.right=this.right.right,this.left.right=this.left.left,this.left.left=e,this.left.node=t,this.left.updateInNewLocation(),this.updateInNewLocation()},AVLTree.prototype.updateInNewLocation=function(){this.getDepthFromChildren()},AVLTree.prototype.getDepthFromChildren=function(){this.depth=null==this.node?0:1,null!=this.left&&(this.depth=this.left.depth+1),null!=this.right&&this.depth<=this.right.depth&&(this.depth=this.right.depth+1)},AVLTree.prototype.add=function(t){if(t===this.node)return!1;var e=function(t,e){if(t===e)return 0;if(t.compareDocumentPosition){var r=t.compareDocumentPosition(e);return 1&r||10&r?1:20&r?-1:0}for(var n=0,o=0,s=t;null!=s;s=s.parentNode||s.ownerElement)n++;for(var i=e;null!=i;i=i.parentNode||i.ownerElement)o++;if(n>o){for(;n>o;)t=t.parentNode||t.ownerElement,n--;if(t===e)return 1}else if(o>n){for(;o>n;)e=e.parentNode||e.ownerElement,o--;if(t===e)return -1}for(var a=t.parentNode||t.ownerElement,u=e.parentNode||e.ownerElement;a!==u;)t=a,e=u,a=t.parentNode||t.ownerElement,u=e.parentNode||e.ownerElement;var p=isAttributeLike(t),c=isAttributeLike(e);if(p&&!c)return -1;if(!p&&c)return 1;if(t.isXPathNamespace){if(t.nodeValue===XPath.XML_NAMESPACE_URI||!e.isXPathNamespace)return -1;if(e.nodeValue===XPath.XML_NAMESPACE_URI)return 1}else if(e.isXPathNamespace)return 1;if(a)for(var h=p?a.attributes:a.childNodes,l=h.length,f=t.baseNode||t,N=e.baseNode||e,E=0;E<l;E+=1){var d=h[E];if(d===f)return -1;if(d===N)return 1}throw Error("Unexpected: could not determine node order")}(t,this.node),r=!1;return -1==e?null==this.left?(this.left=new AVLTree(t),r=!0):(r=this.left.add(t))&&this.balance():1==e&&(null==this.right?(this.right=new AVLTree(t),r=!0):(r=this.right.add(t))&&this.balance()),r&&this.getDepthFromChildren(),r},XNodeSet.prototype=new Expression,XNodeSet.prototype.constructor=XNodeSet,XNodeSet.superclass=Expression.prototype,XNodeSet.prototype.init=function(){this.tree=null,this.nodes=[],this.size=0},XNodeSet.prototype.toString=function(){var t=this.first();return null==t?"":this.stringForNode(t)},XNodeSet.prototype.evaluate=function(t){return this},XNodeSet.prototype.string=function(){return new XString(this.toString())},XNodeSet.prototype.stringValue=function(){return this.toString()},XNodeSet.prototype.number=function(){return new XNumber(this.string())},XNodeSet.prototype.numberValue=function(){return Number(this.string())},XNodeSet.prototype.bool=function(){return new XBoolean(this.booleanValue())},XNodeSet.prototype.booleanValue=function(){return!!this.size},XNodeSet.prototype.nodeset=function(){return this},XNodeSet.prototype.stringForNode=function(t){return t.nodeType==a.DOCUMENT_NODE||t.nodeType==a.ELEMENT_NODE||t.nodeType===a.DOCUMENT_FRAGMENT_NODE?this.stringForContainerNode(t):t.nodeType===a.ATTRIBUTE_NODE?t.value||t.nodeValue:t.isNamespaceNode?t.namespace:t.nodeValue},XNodeSet.prototype.stringForContainerNode=function(t){for(var e="",r=t.firstChild;null!=r;r=r.nextSibling){var n=r.nodeType;(1===n||3===n||4===n||9===n||11===n)&&(e+=this.stringForNode(r))}return e},XNodeSet.prototype.buildTree=function(){if(!this.tree&&this.nodes.length){this.tree=new AVLTree(this.nodes[0]);for(var t=1;t<this.nodes.length;t+=1)this.tree.add(this.nodes[t])}return this.tree},XNodeSet.prototype.first=function(){var t=this.buildTree();if(null==t)return null;for(;null!=t.left;)t=t.left;return t.node},XNodeSet.prototype.add=function(t){for(var e=0;e<this.nodes.length;e+=1)if(t===this.nodes[e])return;this.tree=null,this.nodes.push(t),this.size+=1},XNodeSet.prototype.addArray=function(t){var e=this;forEach(function(t){e.add(t)},t)},XNodeSet.prototype.toArray=function(){var t=[];return this.toArrayRec(this.buildTree(),t),t},XNodeSet.prototype.toArrayRec=function(t,e){null!=t&&(this.toArrayRec(t.left,e),e.push(t.node),this.toArrayRec(t.right,e))},XNodeSet.prototype.toUnsortedArray=function(){return this.nodes.slice()},XNodeSet.prototype.compareWithString=function(t,e){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var o=r[n],s=e(new XString(this.stringForNode(o)),t);if(s.booleanValue())return s}return new XBoolean(!1)},XNodeSet.prototype.compareWithNumber=function(t,e){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var o=r[n],s=e(new XNumber(this.stringForNode(o)),t);if(s.booleanValue())return s}return new XBoolean(!1)},XNodeSet.prototype.compareWithBoolean=function(t,e){return e(this.bool(),t)},XNodeSet.prototype.compareWithNodeSet=function(t,e){for(var r=this.toUnsortedArray(),oInvert=function(t,r){return e(r,t)},n=0;n<r.length;n++){var o=new XString(this.stringForNode(r[n])),s=t.compareWithString(o,oInvert);if(s.booleanValue())return s}return new XBoolean(!1)},XNodeSet.compareWith=(e=function(t,e){return h.instance_of(e,XString)?this.compareWithString(e,t):h.instance_of(e,XNumber)?this.compareWithNumber(e,t):h.instance_of(e,XBoolean)?this.compareWithBoolean(e,t):this.compareWithNodeSet(e,t)},r=Array.prototype.slice,n=e.length,o=function(){var t=r.call(arguments);return t.length<n?function(){return o.apply(this,t.concat(r.call(arguments)))}:e.apply(this,r.apply(arguments,[0,n]))}),XNodeSet.prototype.equals=XNodeSet.compareWith(p.equals),XNodeSet.prototype.notequal=XNodeSet.compareWith(p.notequal),XNodeSet.prototype.lessthan=XNodeSet.compareWith(p.lessthan),XNodeSet.prototype.greaterthan=XNodeSet.compareWith(p.greaterthan),XNodeSet.prototype.lessthanorequal=XNodeSet.compareWith(p.lessthanorequal),XNodeSet.prototype.greaterthanorequal=XNodeSet.compareWith(p.greaterthanorequal),XNodeSet.prototype.union=function(t){var e=new XNodeSet;return e.addArray(this.toUnsortedArray()),e.addArray(t.toUnsortedArray()),e},XPathNamespace.prototype={},XPathNamespace.prototype.constructor=XPathNamespace,XPathNamespace.superclass=Object.prototype,XPathNamespace.prototype.toString=function(){return'{ "'+this.prefix+'", "'+this.namespaceURI+'" }'},XPathContext.prototype={},XPathContext.prototype.constructor=XPathContext,XPathContext.superclass=Object.prototype,XPathContext.prototype.extend=function(t){return assign(new XPathContext,this,t)},VariableResolver.prototype={},VariableResolver.prototype.constructor=VariableResolver,VariableResolver.superclass=Object.prototype,VariableResolver.prototype.getVariable=function(t,e){return null},FunctionResolver.prototype={},FunctionResolver.prototype.constructor=FunctionResolver,FunctionResolver.superclass=Object.prototype,FunctionResolver.prototype.addStandardFunctions=function(){this.functions["{}last"]=c.last,this.functions["{}position"]=c.position,this.functions["{}count"]=c.count,this.functions["{}id"]=c.id,this.functions["{}local-name"]=c.localName,this.functions["{}namespace-uri"]=c.namespaceURI,this.functions["{}name"]=c.name,this.functions["{}string"]=c.string,this.functions["{}concat"]=c.concat,this.functions["{}starts-with"]=c.startsWith,this.functions["{}contains"]=c.contains,this.functions["{}substring-before"]=c.substringBefore,this.functions["{}substring-after"]=c.substringAfter,this.functions["{}substring"]=c.substring,this.functions["{}string-length"]=c.stringLength,this.functions["{}normalize-space"]=c.normalizeSpace,this.functions["{}translate"]=c.translate,this.functions["{}boolean"]=c.boolean_,this.functions["{}not"]=c.not,this.functions["{}true"]=c.true_,this.functions["{}false"]=c.false_,this.functions["{}lang"]=c.lang,this.functions["{}number"]=c.number,this.functions["{}sum"]=c.sum,this.functions["{}floor"]=c.floor,this.functions["{}ceiling"]=c.ceiling,this.functions["{}round"]=c.round},FunctionResolver.prototype.addFunction=function(t,e,r){this.functions["{"+t+"}"+e]=r},FunctionResolver.getFunctionFromContext=function(t,e){var r=h.resolveQName(t,e.namespaceResolver,e.contextNode,!1);if(null===r[0])throw Error("Cannot resolve QName "+name);return e.functionResolver.getFunction(r[1],r[0])},FunctionResolver.prototype.getFunction=function(t,e){return this.functions["{"+e+"}"+t]},NamespaceResolver.prototype={},NamespaceResolver.prototype.constructor=NamespaceResolver,NamespaceResolver.superclass=Object.prototype,NamespaceResolver.prototype.getNamespace=function(t,e){if("xml"==t)return XPath.XML_NAMESPACE_URI;if("xmlns"==t)return XPath.XMLNS_NAMESPACE_URI;for(e.nodeType==a.DOCUMENT_NODE?e=e.documentElement:e.nodeType==a.ATTRIBUTE_NODE?e=PathExpr.getOwnerElement(e):e.nodeType!=a.ELEMENT_NODE&&(e=e.parentNode);null!=e&&e.nodeType==a.ELEMENT_NODE;){for(var r=e.attributes,n=0;n<r.length;n++){var o=r.item(n),s=o.name||o.nodeName;if("xmlns"===s&&""===t||s==="xmlns:"+t)return String(o.value||o.nodeValue)}e=e.parentNode}return null};var c={};c.last=function(t){if(1!=arguments.length)throw Error("Function last expects ()");return new XNumber(t.contextSize)},c.position=function(t){if(1!=arguments.length)throw Error("Function position expects ()");return new XNumber(t.contextPosition)},c.count=function(){var t,e=arguments[0];if(2!=arguments.length||!h.instance_of(t=arguments[1].evaluate(e),XNodeSet))throw Error("Function count expects (node-set)");return new XNumber(t.size)},c.id=function(){var t,e,r=arguments[0];if(2!=arguments.length)throw Error("Function id expects (object)");t=arguments[1].evaluate(r);for(var n=(t=h.instance_of(t,XNodeSet)?t.toArray().join(" "):t.stringValue()).split(/[\x0d\x0a\x09\x20]+/),o=new XNodeSet,s=r.contextNode.nodeType==a.DOCUMENT_NODE?r.contextNode:r.contextNode.ownerDocument,i=0;i<n.length;i++)null!=(e=s.getElementById?s.getElementById(n[i]):h.getElementById(s,n[i]))&&o.add(e);return o},c.localName=function(t,e){var r;if(1==arguments.length)r=t.contextNode;else if(2==arguments.length)r=e.evaluate(t).first();else throw Error("Function local-name expects (node-set?)");return new XString(null==r?"":r.localName||r.baseName||r.target||r.nodeName||"")},c.namespaceURI=function(){var t,e=arguments[0];if(1==arguments.length)t=e.contextNode;else if(2==arguments.length)t=arguments[1].evaluate(e).first();else throw Error("Function namespace-uri expects (node-set?)");return new XString(null==t?"":t.namespaceURI||"")},c.name=function(){var t,e=arguments[0];if(1==arguments.length)t=e.contextNode;else if(2==arguments.length)t=arguments[1].evaluate(e).first();else throw Error("Function name expects (node-set?)");return new XString(null==t?"":t.nodeType==a.ELEMENT_NODE?t.nodeName:t.nodeType==a.ATTRIBUTE_NODE?t.name||t.nodeName:t.nodeType===a.PROCESSING_INSTRUCTION_NODE?t.target||t.nodeName:null==t.localName?"":t.localName)},c.string=function(){var t=arguments[0];if(1==arguments.length)return new XString(XNodeSet.prototype.stringForNode(t.contextNode));if(2==arguments.length)return arguments[1].evaluate(t).string();throw Error("Function string expects (object?)")},c.concat=function(t){if(arguments.length<3)throw Error("Function concat expects (string, string[, string]*)");for(var e="",r=1;r<arguments.length;r++)e+=arguments[r].evaluate(t).stringValue();return new XString(e)},c.startsWith=function(){var t=arguments[0];if(3!=arguments.length)throw Error("Function startsWith expects (string, string)");var e=arguments[1].evaluate(t).stringValue(),r=arguments[2].evaluate(t).stringValue();return new XBoolean(e.substring(0,r.length)==r)},c.contains=function(){var t=arguments[0];if(3!=arguments.length)throw Error("Function contains expects (string, string)");var e=arguments[1].evaluate(t).stringValue(),r=arguments[2].evaluate(t).stringValue();return new XBoolean(-1!==e.indexOf(r))},c.substringBefore=function(){var t=arguments[0];if(3!=arguments.length)throw Error("Function substring-before expects (string, string)");var e=arguments[1].evaluate(t).stringValue(),r=arguments[2].evaluate(t).stringValue();return new XString(e.substring(0,e.indexOf(r)))},c.substringAfter=function(){var t=arguments[0];if(3!=arguments.length)throw Error("Function substring-after expects (string, string)");var e=arguments[1].evaluate(t).stringValue(),r=arguments[2].evaluate(t).stringValue();if(0==r.length)return new XString(e);var n=e.indexOf(r);return new XString(-1==n?"":e.substring(n+r.length))},c.substring=function(){var t=arguments[0];if(!(3==arguments.length||4==arguments.length))throw Error("Function substring expects (string, number, number?)");var e=arguments[1].evaluate(t).stringValue(),r=Math.round(arguments[2].evaluate(t).numberValue())-1,n=4==arguments.length?r+Math.round(arguments[3].evaluate(t).numberValue()):void 0;return new XString(e.substring(r,n))},c.stringLength=function(){var t,e=arguments[0];if(1==arguments.length)t=XNodeSet.prototype.stringForNode(e.contextNode);else if(2==arguments.length)t=arguments[1].evaluate(e).stringValue();else throw Error("Function string-length expects (string?)");return new XNumber(t.length)},c.normalizeSpace=function(){var t,e=arguments[0];if(1==arguments.length)t=XNodeSet.prototype.stringForNode(e.contextNode);else if(2==arguments.length)t=arguments[1].evaluate(e).stringValue();else throw Error("Function normalize-space expects (string?)");for(var r=0,n=t.length-1;h.isSpace(t.charCodeAt(n));)n--;for(var o="";r<=n&&h.isSpace(t.charCodeAt(r));)r++;for(;r<=n;)if(h.isSpace(t.charCodeAt(r)))for(o+=" ";r<=n&&h.isSpace(t.charCodeAt(r));)r++;else o+=t.charAt(r),r++;return new XString(o)},c.translate=function(t,e,r,n){if(4!=arguments.length)throw Error("Function translate expects (string, string, string)");var o=e.evaluate(t).stringValue(),s=r.evaluate(t).stringValue(),i=n.evaluate(t).stringValue(),a=reduce(function(t,e,r){return e in t||(t[e]=r>i.length?"":i[r]),t},{},s),u=join("",map(function(t){return t in a?a[t]:t},o));return new XString(u)},c.boolean_=function(){var t=arguments[0];if(2!=arguments.length)throw Error("Function boolean expects (object)");return arguments[1].evaluate(t).bool()},c.not=function(t,e){if(2!=arguments.length)throw Error("Function not expects (object)");return e.evaluate(t).bool().not()},c.true_=function(){if(1!=arguments.length)throw Error("Function true expects ()");return XBoolean.true_},c.false_=function(){if(1!=arguments.length)throw Error("Function false expects ()");return XBoolean.false_},c.lang=function(){var t,e=arguments[0];if(2!=arguments.length)throw Error("Function lang expects (string)");for(var r=e.contextNode;null!=r&&r.nodeType!=a.DOCUMENT_NODE;r=r.parentNode){var n=r.getAttributeNS(XPath.XML_NAMESPACE_URI,"lang");if(null!=n){t=String(n);break}}if(null==t)return XBoolean.false_;var o=arguments[1].evaluate(e).stringValue();return new XBoolean(t.substring(0,o.length)==o&&(t.length==o.length||"-"==t.charAt(o.length)))},c.number=function(){var t=arguments[0];if(!(1==arguments.length||2==arguments.length))throw Error("Function number expects (object?)");return 1==arguments.length?new XNumber(XNodeSet.prototype.stringForNode(t.contextNode)):arguments[1].evaluate(t).number()},c.sum=function(){var t,e=arguments[0];if(2!=arguments.length||!h.instance_of(t=arguments[1].evaluate(e),XNodeSet))throw Error("Function sum expects (node-set)");t=t.toUnsortedArray();for(var r=0,n=0;n<t.length;n++)r+=new XNumber(XNodeSet.prototype.stringForNode(t[n])).numberValue();return new XNumber(r)},c.floor=function(){var t=arguments[0];if(2!=arguments.length)throw Error("Function floor expects (number)");return new XNumber(Math.floor(arguments[1].evaluate(t).numberValue()))},c.ceiling=function(){var t=arguments[0];if(2!=arguments.length)throw Error("Function ceiling expects (number)");return new XNumber(Math.ceil(arguments[1].evaluate(t).numberValue()))},c.round=function(){var t=arguments[0];if(2!=arguments.length)throw Error("Function round expects (number)");return new XNumber(Math.round(arguments[1].evaluate(t).numberValue()))};var h={},isAttributeLike=function(t){return t&&(t.nodeType===a.ATTRIBUTE_NODE||t.ownerElement||t.isXPathNamespace)};h.splitQName=function(t){var e=t.indexOf(":");return -1==e?[null,t]:[t.substring(0,e),t.substring(e+1)]},h.resolveQName=function(t,e,r,n){var o=h.splitQName(t);return null!=o[0]?o[0]=e.getNamespace(o[0],r):n?(o[0]=e.getNamespace("",r),null==o[0]&&(o[0]="")):o[0]="",o},h.isSpace=function(t){return 9==t||13==t||10==t||32==t},h.isLetter=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=255||t>=256&&t<=305||t>=308&&t<=318||t>=321&&t<=328||t>=330&&t<=382||t>=384&&t<=451||t>=461&&t<=496||t>=500&&t<=501||t>=506&&t<=535||t>=592&&t<=680||t>=699&&t<=705||902==t||t>=904&&t<=906||908==t||t>=910&&t<=929||t>=931&&t<=974||t>=976&&t<=982||986==t||988==t||990==t||992==t||t>=994&&t<=1011||t>=1025&&t<=1036||t>=1038&&t<=1103||t>=1105&&t<=1116||t>=1118&&t<=1153||t>=1168&&t<=1220||t>=1223&&t<=1224||t>=1227&&t<=1228||t>=1232&&t<=1259||t>=1262&&t<=1269||t>=1272&&t<=1273||t>=1329&&t<=1366||1369==t||t>=1377&&t<=1414||t>=1488&&t<=1514||t>=1520&&t<=1522||t>=1569&&t<=1594||t>=1601&&t<=1610||t>=1649&&t<=1719||t>=1722&&t<=1726||t>=1728&&t<=1742||t>=1744&&t<=1747||1749==t||t>=1765&&t<=1766||t>=2309&&t<=2361||2365==t||t>=2392&&t<=2401||t>=2437&&t<=2444||t>=2447&&t<=2448||t>=2451&&t<=2472||t>=2474&&t<=2480||2482==t||t>=2486&&t<=2489||t>=2524&&t<=2525||t>=2527&&t<=2529||t>=2544&&t<=2545||t>=2565&&t<=2570||t>=2575&&t<=2576||t>=2579&&t<=2600||t>=2602&&t<=2608||t>=2610&&t<=2611||t>=2613&&t<=2614||t>=2616&&t<=2617||t>=2649&&t<=2652||2654==t||t>=2674&&t<=2676||t>=2693&&t<=2699||2701==t||t>=2703&&t<=2705||t>=2707&&t<=2728||t>=2730&&t<=2736||t>=2738&&t<=2739||t>=2741&&t<=2745||2749==t||2784==t||t>=2821&&t<=2828||t>=2831&&t<=2832||t>=2835&&t<=2856||t>=2858&&t<=2864||t>=2866&&t<=2867||t>=2870&&t<=2873||2877==t||t>=2908&&t<=2909||t>=2911&&t<=2913||t>=2949&&t<=2954||t>=2958&&t<=2960||t>=2962&&t<=2965||t>=2969&&t<=2970||2972==t||t>=2974&&t<=2975||t>=2979&&t<=2980||t>=2984&&t<=2986||t>=2990&&t<=2997||t>=2999&&t<=3001||t>=3077&&t<=3084||t>=3086&&t<=3088||t>=3090&&t<=3112||t>=3114&&t<=3123||t>=3125&&t<=3129||t>=3168&&t<=3169||t>=3205&&t<=3212||t>=3214&&t<=3216||t>=3218&&t<=3240||t>=3242&&t<=3251||t>=3253&&t<=3257||3294==t||t>=3296&&t<=3297||t>=3333&&t<=3340||t>=3342&&t<=3344||t>=3346&&t<=3368||t>=3370&&t<=3385||t>=3424&&t<=3425||t>=3585&&t<=3630||3632==t||t>=3634&&t<=3635||t>=3648&&t<=3653||t>=3713&&t<=3714||3716==t||t>=3719&&t<=3720||3722==t||3725==t||t>=3732&&t<=3735||t>=3737&&t<=3743||t>=3745&&t<=3747||3749==t||3751==t||t>=3754&&t<=3755||t>=3757&&t<=3758||3760==t||t>=3762&&t<=3763||3773==t||t>=3776&&t<=3780||t>=3904&&t<=3911||t>=3913&&t<=3945||t>=4256&&t<=4293||t>=4304&&t<=4342||4352==t||t>=4354&&t<=4355||t>=4357&&t<=4359||4361==t||t>=4363&&t<=4364||t>=4366&&t<=4370||4412==t||4414==t||4416==t||4428==t||4430==t||4432==t||t>=4436&&t<=4437||4441==t||t>=4447&&t<=4449||4451==t||4453==t||4455==t||4457==t||t>=4461&&t<=4462||t>=4466&&t<=4467||4469==t||4510==t||4520==t||4523==t||t>=4526&&t<=4527||t>=4535&&t<=4536||4538==t||t>=4540&&t<=4546||4587==t||4592==t||4601==t||t>=7680&&t<=7835||t>=7840&&t<=7929||t>=7936&&t<=7957||t>=7960&&t<=7965||t>=7968&&t<=8005||t>=8008&&t<=8013||t>=8016&&t<=8023||8025==t||8027==t||8029==t||t>=8031&&t<=8061||t>=8064&&t<=8116||t>=8118&&t<=8124||8126==t||t>=8130&&t<=8132||t>=8134&&t<=8140||t>=8144&&t<=8147||t>=8150&&t<=8155||t>=8160&&t<=8172||t>=8178&&t<=8180||t>=8182&&t<=8188||8486==t||t>=8490&&t<=8491||8494==t||t>=8576&&t<=8578||t>=12353&&t<=12436||t>=12449&&t<=12538||t>=12549&&t<=12588||t>=44032&&t<=55203||t>=19968&&t<=40869||12295==t||t>=12321&&t<=12329},h.isNCNameChar=function(t){return t>=48&&t<=57||t>=1632&&t<=1641||t>=1776&&t<=1785||t>=2406&&t<=2415||t>=2534&&t<=2543||t>=2662&&t<=2671||t>=2790&&t<=2799||t>=2918&&t<=2927||t>=3047&&t<=3055||t>=3174&&t<=3183||t>=3302&&t<=3311||t>=3430&&t<=3439||t>=3664&&t<=3673||t>=3792&&t<=3801||t>=3872&&t<=3881||46==t||45==t||95==t||h.isLetter(t)||t>=768&&t<=837||t>=864&&t<=865||t>=1155&&t<=1158||t>=1425&&t<=1441||t>=1443&&t<=1465||t>=1467&&t<=1469||1471==t||t>=1473&&t<=1474||1476==t||t>=1611&&t<=1618||1648==t||t>=1750&&t<=1756||t>=1757&&t<=1759||t>=1760&&t<=1764||t>=1767&&t<=1768||t>=1770&&t<=1773||t>=2305&&t<=2307||2364==t||t>=2366&&t<=2380||2381==t||t>=2385&&t<=2388||t>=2402&&t<=2403||t>=2433&&t<=2435||2492==t||2494==t||2495==t||t>=2496&&t<=2500||t>=2503&&t<=2504||t>=2507&&t<=2509||2519==t||t>=2530&&t<=2531||2562==t||2620==t||2622==t||2623==t||t>=2624&&t<=2626||t>=2631&&t<=2632||t>=2635&&t<=2637||t>=2672&&t<=2673||t>=2689&&t<=2691||2748==t||t>=2750&&t<=2757||t>=2759&&t<=2761||t>=2763&&t<=2765||t>=2817&&t<=2819||2876==t||t>=2878&&t<=2883||t>=2887&&t<=2888||t>=2891&&t<=2893||t>=2902&&t<=2903||t>=2946&&t<=2947||t>=3006&&t<=3010||t>=3014&&t<=3016||t>=3018&&t<=3021||3031==t||t>=3073&&t<=3075||t>=3134&&t<=3140||t>=3142&&t<=3144||t>=3146&&t<=3149||t>=3157&&t<=3158||t>=3202&&t<=3203||t>=3262&&t<=3268||t>=3270&&t<=3272||t>=3274&&t<=3277||t>=3285&&t<=3286||t>=3330&&t<=3331||t>=3390&&t<=3395||t>=3398&&t<=3400||t>=3402&&t<=3405||3415==t||3633==t||t>=3636&&t<=3642||t>=3655&&t<=3662||3761==t||t>=3764&&t<=3769||t>=3771&&t<=3772||t>=3784&&t<=3789||t>=3864&&t<=3865||3893==t||3895==t||3897==t||3902==t||3903==t||t>=3953&&t<=3972||t>=3974&&t<=3979||t>=3984&&t<=3989||3991==t||t>=3993&&t<=4013||t>=4017&&t<=4023||4025==t||t>=8400&&t<=8412||8417==t||t>=12330&&t<=12335||12441==t||12442==t||183==t||720==t||721==t||903==t||1600==t||3654==t||3782==t||12293==t||t>=12337&&t<=12341||t>=12445&&t<=12446||t>=12540&&t<=12542},h.coalesceText=function(t){for(var e=t.firstChild;null!=e;e=e.nextSibling)if(e.nodeType==a.TEXT_NODE||e.nodeType==a.CDATA_SECTION_NODE){var r=e.nodeValue,n=e;for(e=e.nextSibling;null!=e&&(e.nodeType==a.TEXT_NODE||e.nodeType==a.CDATA_SECTION_NODE);){r+=e.nodeValue;var o=e;e=e.nextSibling,o.parentNode.removeChild(o)}if(n.nodeType==a.CDATA_SECTION_NODE){var s=n.parentNode;if(null==n.nextSibling)s.removeChild(n),s.appendChild(s.ownerDocument.createTextNode(r));else{var i=n.nextSibling;s.removeChild(n),s.insertBefore(s.ownerDocument.createTextNode(r),i)}}else n.nodeValue=r;if(null==e)break}else e.nodeType==a.ELEMENT_NODE&&h.coalesceText(e)},h.instance_of=function(t,e){for(;null!=t;){if(t.constructor===e)return!0;if(t===Object)break;t=t.constructor.superclass}return!1},h.getElementById=function(t,e){if(t.nodeType==a.ELEMENT_NODE&&(t.getAttribute("id")==e||t.getAttributeNS(null,"id")==e))return t;for(var r=t.firstChild;null!=r;r=r.nextSibling){var n=h.getElementById(r,e);if(null!=n)return n}return null};var l=function(){function XPathException(t,e,r){var n=Error.call(this,function(t,e){var r=e?": "+e.toString():"";switch(t){case XPathException.INVALID_EXPRESSION_ERR:return"Invalid expression"+r;case XPathException.TYPE_ERR:return"Type error"+r}return null}(t,e)||r);return n.code=t,n.exception=e,n}return XPathException.prototype=Object.create(Error.prototype),XPathException.prototype.constructor=XPathException,XPathException.superclass=Error,XPathException.prototype.toString=function(){return this.message},XPathException.fromMessage=function(t,e){return new XPathException(null,e,t)},XPathException.INVALID_EXPRESSION_ERR=51,XPathException.TYPE_ERR=52,XPathException}();function XPathExpression(t,e,r){this.xpath=r.parse(t),this.context=new XPathContext,this.context.namespaceResolver=new XPathNSResolverWrapper(e)}function XPathNSResolverWrapper(t){this.xpathNSResolver=t}function NodeXPathNSResolver(t){this.node=t,this.namespaceResolver=new NamespaceResolver}function XPathResult(t,e){switch(e==XPathResult.ANY_TYPE&&(t.constructor===XString?e=XPathResult.STRING_TYPE:t.constructor===XNumber?e=XPathResult.NUMBER_TYPE:t.constructor===XBoolean?e=XPathResult.BOOLEAN_TYPE:t.constructor===XNodeSet&&(e=XPathResult.UNORDERED_NODE_ITERATOR_TYPE)),this.resultType=e,e){case XPathResult.NUMBER_TYPE:this.numberValue=t.numberValue();return;case XPathResult.STRING_TYPE:this.stringValue=t.stringValue();return;case XPathResult.BOOLEAN_TYPE:this.booleanValue=t.booleanValue();return;case XPathResult.ANY_UNORDERED_NODE_TYPE:case XPathResult.FIRST_ORDERED_NODE_TYPE:if(t.constructor===XNodeSet){this.singleNodeValue=t.first();return}break;case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:case XPathResult.ORDERED_NODE_ITERATOR_TYPE:if(t.constructor===XNodeSet){this.invalidIteratorState=!1,this.nodes=t.toArray(),this.iteratorIndex=0;return}break;case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:if(t.constructor===XNodeSet){this.nodes=t.toArray(),this.snapshotLength=this.nodes.length;return}}throw new l(l.TYPE_ERR)}function installDOM3XPathSupport(t,e){t.createExpression=function(t,r){try{return new XPathExpression(t,r,e)}catch(t){throw new l(l.INVALID_EXPRESSION_ERR,t)}},t.createNSResolver=function(t){return new NodeXPathNSResolver(t)},t.evaluate=function(r,n,o,s,i){if(s<0||s>9)throw{code:0,toString:function(){return"Request type not supported"}};return t.createExpression(r,o,e).evaluate(n,s,i)}}XPathExpression.prototype={},XPathExpression.prototype.constructor=XPathExpression,XPathExpression.superclass=Object.prototype,XPathExpression.getOwnerDocument=function(t){return t.nodeType===a.DOCUMENT_NODE?t:t.ownerDocument},XPathExpression.detectHtmlDom=function(t){if(!t)return!1;var e=XPathExpression.getOwnerDocument(t);try{return e.implementation.hasFeature("HTML","2.0")}catch(t){return!0}},XPathExpression.prototype.evaluate=function(t,e,r){this.context.expressionContextNode=t,this.context.caseInsensitive=XPathExpression.detectHtmlDom(t);var n=this.xpath.evaluate(this.context);return new XPathResult(n,e)},XPathNSResolverWrapper.prototype={},XPathNSResolverWrapper.prototype.constructor=XPathNSResolverWrapper,XPathNSResolverWrapper.superclass=Object.prototype,XPathNSResolverWrapper.prototype.getNamespace=function(t,e){return null==this.xpathNSResolver?null:this.xpathNSResolver.lookupNamespaceURI(t)},NodeXPathNSResolver.prototype={},NodeXPathNSResolver.prototype.constructor=NodeXPathNSResolver,NodeXPathNSResolver.superclass=Object.prototype,NodeXPathNSResolver.prototype.lookupNamespaceURI=function(t){return this.namespaceResolver.getNamespace(t,this.node)},XPathResult.prototype={},XPathResult.prototype.constructor=XPathResult,XPathResult.superclass=Object.prototype,XPathResult.prototype.iterateNext=function(){if(this.resultType!=XPathResult.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=XPathResult.ORDERED_NODE_ITERATOR_TYPE)throw new l(l.TYPE_ERR);return this.nodes[this.iteratorIndex++]},XPathResult.prototype.snapshotItem=function(t){if(this.resultType!=XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=XPathResult.ORDERED_NODE_SNAPSHOT_TYPE)throw new l(l.TYPE_ERR);return this.nodes[t]},XPathResult.ANY_TYPE=0,XPathResult.NUMBER_TYPE=1,XPathResult.STRING_TYPE=2,XPathResult.BOOLEAN_TYPE=3,XPathResult.UNORDERED_NODE_ITERATOR_TYPE=4,XPathResult.ORDERED_NODE_ITERATOR_TYPE=5,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE=6,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE=7,XPathResult.ANY_UNORDERED_NODE_TYPE=8,XPathResult.FIRST_ORDERED_NODE_TYPE=9;try{var f=!0;try{document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("XPath",null)&&(f=!1)}catch(t){}f&&installDOM3XPathSupport(document,new XPathParser)}catch(t){}installDOM3XPathSupport(t,new XPathParser),function(){var e=new XPathParser,r=new NamespaceResolver,n=new FunctionResolver,o=new VariableResolver;function makeNSResolverFromFunction(t){return{getNamespace:function(e,n){return t(e,n)||r.getNamespace(e,n)}}}function convertValue(t){if(null==t||t instanceof XString||t instanceof XBoolean||t instanceof XNumber||t instanceof XNodeSet)return t;switch(typeof t){case"string":return new XString(t);case"boolean":return new XBoolean(t);case"number":return new XNumber(t)}var e=new XNodeSet;return e.addArray([].concat(t)),e}function makeFunctionResolverFromFunction(t){return{getFunction:function(e,r){var o=t(e,r);return o?function(t){var e=Array.prototype.slice.call(arguments,1).map(function(e){return e.evaluate(t)});return convertValue(o.apply(this,[].concat(t,e)))}:n.getFunction(e,r)}}}function makeVariableResolverFromFunction(t){return{getVariable:function(e,r){return convertValue(t(e,r))}}}function copyIfPresent(t,e,r){t in r&&(e[t]=r[t])}var s={evaluate:function(t){var e,s,i,a;return e=this.expression,s=new XPathContext,t?(s.namespaceResolver=(i=t.namespaces)&&"function"==typeof i.getNamespace?makeNSResolverFromFunction(i.getNamespace.bind(i)):"function"==typeof i?makeNSResolverFromFunction(i):"object"==typeof i?makeNSResolverFromFunction(function(t){return i[t]}):r,s.functionResolver=(a=t.functions)&&"function"==typeof a.getFunction?makeFunctionResolverFromFunction(a.getFunction.bind(a)):"function"==typeof a?makeFunctionResolverFromFunction(a):"object"==typeof a?makeFunctionResolverFromFunction(function(t){return a[t]}):n,s.variableResolver=function(t){if(t){if("function"==typeof t.getVariable)return makeVariableResolverFromFunction(t.getVariable.bind(t));if("function"==typeof t)return makeVariableResolverFromFunction(t);if("object"==typeof t)return makeVariableResolverFromFunction(function(e){return t[e]})}return o}(t.variables),s.expressionContextNode=t.node,copyIfPresent("allowAnyNamespaceForNoPrefix",s,t),copyIfPresent("isHtml",s,t)):s.namespaceResolver=r,e.evaluate(s)},evaluateNumber:function(t){return this.evaluate(t).numberValue()},evaluateString:function(t){return this.evaluate(t).stringValue()},evaluateBoolean:function(t){return this.evaluate(t).booleanValue()},evaluateNodeSet:function(t){return this.evaluate(t).nodeset()},select:function(t){return this.evaluateNodeSet(t).toArray()},select1:function(t){return this.select(t)[0]}};t.parse=function(t){return Object.create(s,{expression:{value:e.parse(t)}})}}(),assign(t,{XPath:XPath,XPathParser:XPathParser,XPathResult:XPathResult,Step:Step,PathExpr:PathExpr,NodeTest:NodeTest,LocationPath:LocationPath,OrOperation:OrOperation,AndOperation:AndOperation,BarOperation:BarOperation,EqualsOperation:EqualsOperation,NotEqualOperation:NotEqualOperation,LessThanOperation:LessThanOperation,GreaterThanOperation:GreaterThanOperation,LessThanOrEqualOperation:LessThanOrEqualOperation,GreaterThanOrEqualOperation:GreaterThanOrEqualOperation,PlusOperation:PlusOperation,MinusOperation:MinusOperation,MultiplyOperation:MultiplyOperation,DivOperation:DivOperation,ModOperation:ModOperation,UnaryMinusOperation:UnaryMinusOperation,FunctionCall:FunctionCall,VariableReference:VariableReference,XPathContext:XPathContext,XNodeSet:XNodeSet,XBoolean:XBoolean,XString:XString,XNumber:XNumber,NamespaceResolver:NamespaceResolver,FunctionResolver:FunctionResolver,VariableResolver:VariableResolver,Utilities:h}),t.select=function(e,r,n){return t.selectWithResolver(e,r,null,n)},t.useNamespaces=function(e){var r={mappings:e||{},lookupNamespaceURI:function(t){return this.mappings[t]}};return function(e,n,o){return t.selectWithResolver(e,n,r,o)}},t.selectWithResolver=function(t,e,r,n){var o=new XPathExpression(t,r,new XPathParser),s=XPathResult.ANY_TYPE,i=o.evaluate(e,s,null);return i.resultType==XPathResult.STRING_TYPE?i=i.stringValue:i.resultType==XPathResult.NUMBER_TYPE?i=i.numberValue:i.resultType==XPathResult.BOOLEAN_TYPE?i=i.booleanValue:(i=i.nodes,n&&(i=i[0])),i},t.select1=function(e,r){return t.select(e,r,!0)};var isNodeOfType=function(t){return function(e){return isNodeLike(e)&&e.nodeType===t}};assign(t,{isNodeLike:isNodeLike,isArrayOfNodes:function(t){return Array.isArray(t)&&t.every(isNodeLike)},isElement:isNodeOfType(a.ELEMENT_NODE),isAttribute:isNodeOfType(a.ATTRIBUTE_NODE),isTextNode:isNodeOfType(a.TEXT_NODE),isCDATASection:isNodeOfType(a.CDATA_SECTION_NODE),isProcessingInstruction:isNodeOfType(a.PROCESSING_INSTRUCTION_NODE),isComment:isNodeOfType(a.COMMENT_NODE),isDocumentNode:isNodeOfType(a.DOCUMENT_NODE),isDocumentTypeNode:isNodeOfType(a.DOCUMENT_TYPE_NODE),isDocumentFragment:isNodeOfType(a.DOCUMENT_FRAGMENT_NODE)})}(e)}}]);